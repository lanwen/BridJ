<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<title>Selenoid UI. Reference Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Selenoid UI. Reference Guide</h1>
<div class="details">
<span id="revnumber">version latest,</span>
<span id="revdate">2017-05-18</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_links">1. Links</a></li>
<li><a href="#_download">2. Download</a>
<ul class="sectlevel2">
<li><a href="#_get_bridj">2.1. Get BridJ</a>
<ul class="sectlevel3">
<li><a href="#_direct_downloads">2.1.1. Direct downloads</a></li>
<li><a href="#_use_with_maven">2.1.2. Use with Maven</a></li>
<li><a href="#_use_with_sbt">2.1.3. Use with sbt</a></li>
<li><a href="#_specialized_subsets_smaller_jars">2.1.4. Specialized subsets (smaller JARs !)</a></li>
</ul>
</li>
<li><a href="#_platform_notes">2.2. Platform notes</a>
<ul class="sectlevel3">
<li><a href="#_android">2.2.1. Android</a></li>
<li><a href="#_windows">2.2.2. Windows</a></li>
<li><a href="#_linux">2.2.3. Linux</a></li>
<li><a href="#_solaris">2.2.4. Solaris</a></li>
<li><a href="#_macos_x">2.2.5. MacOS X</a></li>
<li><a href="#_ios_jailbroken_iphones_and_ipads">2.2.6. iOS (jailbroken iPhones and iPads)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_current_state">3. Current State</a>
<ul class="sectlevel2">
<li><a href="#_working_features">3.1. Working Features</a></li>
<li><a href="#_known_limitations">3.2. Known limitations</a></li>
<li><a href="#_features_in_progress">3.3. Features in progress</a></li>
<li><a href="#_planned_features">3.4. Planned features</a></li>
<li><a href="#_dynamic_library_dependencies">3.5. Dynamic Library dependencies</a></li>
<li><a href="#_features_not_planned_ruled_out">3.6. Features Not Planned / Ruled Out</a></li>
</ul>
</li>
<li><a href="#_project">4. Project</a>
<ul class="sectlevel2">
<li><a href="#_design">4.1. Design</a>
<ul class="sectlevel3">
<li><a href="#_assembler_optimizations">4.1.1. Assembler optimizations</a></li>
</ul>
</li>
<li><a href="#_bridj_pointers">4.2. BridJ &amp; Pointers</a>
<ul class="sectlevel3">
<li><a href="#_anatomy_of_a_pointer">4.2.1. Anatomy of a pointer</a></li>
<li><a href="#_reading_writing_data">4.2.2. Reading / Writing data</a></li>
<li><a href="#_allocating_memory">4.2.3. Allocating memory</a></li>
<li><a href="#_wrapping_memory">4.2.4. Wrapping memory</a></li>
<li><a href="#_memory_bounds_offsets_iteration">4.2.5. Memory bounds, offsets, iteration</a></li>
<li><a href="#_typed_pointers">4.2.6. Typed pointers</a></li>
<li><a href="#_endianness">4.2.7. Endianness</a></li>
<li><a href="#_casting">4.2.8. Casting</a></li>
</ul>
</li>
<li><a href="#_bridj_callbacks">4.3. BridJ &amp; Callbacks</a>
<ul class="sectlevel3">
<li><a href="#_the_callback_type">4.3.1. The Callback type</a></li>
<li><a href="#_complete_example">4.3.2. Complete example</a></li>
</ul>
</li>
<li><a href="#_binaries_lookup">4.4. Binaries lookup</a>
<ul class="sectlevel3">
<li><a href="#_external_binaries">4.4.1. External binaries</a></li>
<li><a href="#_binaries_embedded_in_jars">4.4.2. Binaries embedded in JARs</a></li>
<li><a href="#_dependent_libraries">4.4.3. Dependent libraries</a></li>
<li><a href="#_jnaerator_support">4.4.4. JNAerator support</a></li>
</ul>
</li>
<li><a href="#_bridj_type_mapping">4.5. BridJ &amp; Type Mapping</a>
<ul class="sectlevel3">
<li><a href="#_structs">4.5.1. Structs</a></li>
<li><a href="#_enums">4.5.2. Enums</a></li>
<li><a href="#_callbacks">4.5.3. Callbacks</a></li>
<li><a href="#_c_class">4.5.4. C++ Class</a></li>
</ul>
</li>
<li><a href="#_backwards_compatibility">4.6. Backwards compatibility</a>
<ul class="sectlevel3">
<li><a href="#_note_on_dependencies">4.6.1. Note on dependencies</a></li>
<li><a href="#_bridj_s_pre_1_0_api_a_moving_target">4.6.2. BridJ&#8217;s pre-1.0 API: a moving target</a></li>
<li><a href="#_what_if_you_need_backwards_compatibility_from_bridj">4.6.3. What if you need backwards-compatibility from BridJ ?</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_language_specific">5. Language Specific</a>
<ul class="sectlevel2">
<li><a href="#_bridj_cpp">5.1. BridJ &amp; CPP</a>
<ul class="sectlevel3">
<li><a href="#_example_of_c_class">5.1.1. Example of C++ class</a></li>
<li><a href="#_runtime_support">5.1.2. Runtime support</a></li>
<li><a href="#_language_support">5.1.3. Language support</a></li>
</ul>
</li>
<li><a href="#_bridj_c">5.2. BridJ &amp; C</a></li>
<li><a href="#_bridj_scala">5.3. BridJ &amp; Scala</a>
<ul class="sectlevel3">
<li><a href="#_pointer">5.3.1. Pointer</a></li>
<li><a href="#_structs_2">5.3.2. Structs</a></li>
</ul>
</li>
<li><a href="#_com">5.4. COM</a>
<ul class="sectlevel3">
<li><a href="#_example">5.4.1. Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_who_s_using_bridj">6. Who&#8217;s using BridJ</a>
<ul class="sectlevel2">
<li><a href="#_stormmq_myxi">6.1. StormMQ Myxi</a></li>
<li><a href="#_directx4java">6.2. directx4java</a></li>
<li><a href="#_jlibav">6.3. jlibav</a></li>
<li><a href="#_openimaj">6.4. OpenIMAJ</a></li>
<li><a href="#_webcam_capture">6.5. webcam-capture</a></li>
<li><a href="#_hunspell_bridj">6.6. hunspell-bridj</a></li>
<li><a href="#_bridj_pcap">6.7. BridJ PCap</a></li>
<li><a href="#__code_geotools_code">6.8. <code>GeoTools</code></a></li>
<li><a href="#_falplayer_android_j">6.9. falplayer-android-j</a></li>
<li><a href="#_javacl">6.10. JavaCL</a></li>
<li><a href="#_scalacl">6.11. ScalaCL</a></li>
</ul>
</li>
<li><a href="#_contributing_to_bridj">7. Contributing to BridJ</a></li>
<li><a href="#_how_to_help">8. How to help</a>
<ul class="sectlevel2">
<li><a href="#_new_projects">8.1. New projects</a></li>
<li><a href="#_bug_fixes_and_enhancements">8.2. Bug Fixes and Enhancements</a></li>
<li><a href="#_graphics">8.3. Graphics</a></li>
<li><a href="#_money_or_hardware_donations">8.4. Money or Hardware donations</a></li>
</ul>
</li>
<li><a href="#_submitting_bugs">9. Submitting Bugs</a>
<ul class="sectlevel2">
<li><a href="#_what_should_go_in_an_ideal_report">9.1. What should go in an ideal report</a></li>
</ul>
</li>
<li><a href="#_google_summer_of_code">10. Google Summer of Code</a>
<ul class="sectlevel2">
<li><a href="#_objective_c_support">10.1. Objective-C support</a></li>
<li><a href="#_library_interceptor_generator">10.2. Library interceptor generator</a></li>
<li><a href="#_jna_to_bridj_converter">10.3. JNA to BridJ Converter</a></li>
<li><a href="#_bridj_net">10.4. BridJ / .NET</a></li>
<li><a href="#_c_to_java_converter_started">10.5. C++ to Java Converter (STARTED)</a></li>
<li><a href="#_new_c_jvm_language">10.6. New C++ / JVM Language</a></li>
<li><a href="#_add_fortran_support">10.7. Add Fortran support</a></li>
</ul>
</li>
<li><a href="#_build">11. Build</a>
<ul class="sectlevel2">
<li><a href="#_build_bridj_only">11.1. Build BridJ only</a></li>
<li><a href="#_build_all_nativelibs4java_projects">11.2. Build all NativeLibs4Java projects</a></li>
<li><a href="#_rebuilding_bridj_s_native_library">11.3. Rebuilding BridJ&#8217;s native library</a>
<ul class="sectlevel3">
<li><a href="#_patch_dyncall">11.3.1. Patch dyncall</a></li>
<li><a href="#_build_the_library">11.3.2. Build the library</a></li>
</ul>
</li>
<li><a href="#_about_bridj_s_source_code">11.4. About BridJ&#8217;s source code</a></li>
</ul>
</li>
<li><a href="#_bridj_s_automated_tests">12. BridJ&#8217;s Automated Tests</a>
<ul class="sectlevel2">
<li><a href="#__code_pointertest_code_and_code_typedpointerstest_code">12.1. <code>PointerTest</code> and <code>TypedPointersTest</code></a></li>
<li><a href="#__code_structtest_code">12.2. <code>StructTest</code></a></li>
<li><a href="#__code_objctest_code">12.3. <code>ObjCTest</code></a></li>
<li><a href="#__code_miscbugstest_code">12.4. <code>MiscBugsTest</code></a></li>
<li><a href="#__code_functiontest_code">12.5. <code>FunctionTest</code></a></li>
<li><a href="#__code_demanglingtest_code">12.6. <code>DemanglingTest</code></a></li>
<li><a href="#__code_cpptest_code">12.7. <code>CPPTest</code></a></li>
<li><a href="#__code_comtest_code">12.8. <code>COMTest</code></a></li>
<li><a href="#__code_comparisontest_code">12.9. <code>ComparisonTest</code></a></li>
<li><a href="#__code_callbacktest_code">12.10. <code>CallbackTest</code></a></li>
<li><a href="#__code_bridjtest_code">12.11. <code>BridJTest</code></a></li>
<li><a href="#__code_calltest_code">12.12. <code>CallTest</code></a></li>
</ul>
</li>
<li><a href="#_test_coverage">13. Test Coverage</a>
<ul class="sectlevel2">
<li><a href="#_running_cobertura">13.1. Running Cobertura</a></li>
<li><a href="#_last_published_cobertura_reports">13.2. Last published Cobertura reports</a></li>
</ul>
</li>
<li><a href="#_faq">Appendix A: FAQ</a>
<ul class="sectlevel2">
<li><a href="#_about">A.1. About</a>
<ul class="sectlevel3">
<li><a href="#_the_project">A.1.1. The project</a></li>
<li><a href="#_how_is_bridj_different_from">A.1.2. How is BridJ different from&#8230;&#8203;</a></li>
<li><a href="#_usage">A.1.3. Usage</a></li>
<li><a href="#_troubleshooting">A.1.4. Troubleshooting</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_credits_and_license">Appendix B: Credits and License</a>
<ul class="sectlevel2">
<li><a href="#_main_author">B.1. Main author</a></li>
<li><a href="#_contributors">B.2. Contributors</a></li>
<li><a href="#_generous_donors">B.3. Generous donors</a></li>
<li><a href="#_projects_used">B.4. Projects Used</a></li>
<li><a href="#_projects_that_use_bridj">B.5. Projects that use BridJ</a></li>
<li><a href="#_licenses">B.6. Licenses</a>
<ul class="sectlevel3">
<li><a href="#_bridj_javacl_scalacl_license_3_clauses_bsd_like">B.6.1. BridJ, JavaCL &amp; ScalaCL License (3-clauses BSD-like)</a></li>
<li><a href="#_dyncall_license_2_clauses_bsd_like">B.6.2. dyncall License (2-clauses BSD-like)</a></li>
<li><a href="#_asm_license_3_clauses_bsd_like">B.6.3. ASM License (3-clauses BSD-like)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>BridJ&#8217;s source code is currently hosted at the <a href="http://code.google.com/p/nativelibs4java/">NativeLibs4Java</a> project.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_links"><a class="anchor" href="#_links"></a>1. Links</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/ochafik/nativelibs4java/tree/master/libraries/BridJ">You can browse BridJ&#8217;s sources from here</a></p>
</li>
<li>
<p><a href="https://github.com/ochafik/nativelibs4java/tree/master/libraries/BridJ/CHANGELOG">Direct link to BridJ&#8217;s CHANGELOG</a></p>
</li>
<li>
<p>Javadoc : <a href="http://nativelibs4java.sourceforge.net/bridj/api/development/org/bridj/Pointer.html">Pointer</a> | <a href="http://nativelibs4java.sourceforge.net/bridj/api/development/">Full</a></p>
</li>
<li>
<p><a href="http://groups.google.com/group/nativelibs4java/">Forum / Support</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_download"><a class="anchor" href="#_download"></a>2. Download</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This page explains how to get and use BridJ using various build management systems and provides platform-specific notes.</p>
</div>
<div class="paragraph">
<p><a href="http://jnaerator.sourceforge.net/webstart/JNAerator/JNAeratorStudio.jnlp">You can try BridJ quickly</a> through <a href="http://jnaerator.googlecode.com/">JNAerator</a> (just select "BridJ" in the "Runtime" combobox).</p>
</div>
<div class="sect2">
<h3 id="_get_bridj"><a class="anchor" href="#_get_bridj"></a>2.1. Get BridJ</h3>
<div class="paragraph">
<p>It is advised to use Maven or sbt to manage dependencies automatically.</p>
</div>
<div class="sect3">
<h4 id="_direct_downloads"><a class="anchor" href="#_direct_downloads"></a>2.1.1. Direct downloads</h4>
<div class="ulist">
<ul>
<li>
<p>Latest release: <a href="http://search.maven.org/#artifactdetails%7Ccom.nativelibs4java%7Cbridj%7C0.7.0%7Cbundle">0.7.0</a></p>
</li>
<li>
<p>Latest snapshot: <a href="https://oss.sonatype.org/content/groups/public/com/nativelibs4java/bridj/0.7-SNAPSHOT/">0.7-SNAPSHOT</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_use_with_maven"><a class="anchor" href="#_use_with_maven"></a>2.1.2. Use with Maven</h4>
<div class="paragraph">
<p>New releases are deployed on <a href="http://search.maven.org/">Maven Central</a>, so you don&#8217;t need to declare any repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencies&gt;</span>
  <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>com.nativelibs4java<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>bridj<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>0.7.0<span class="tag">&lt;/version&gt;</span>
  <span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;/dependencies&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you wish to use a snapshot:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;repositories&gt;</span>
  <span class="tag">&lt;repository&gt;</span>
    <span class="tag">&lt;id&gt;</span>sonatype<span class="tag">&lt;/id&gt;</span>
    <span class="tag">&lt;name&gt;</span>Sonatype OSS Snapshots Repository<span class="tag">&lt;/name&gt;</span>
    <span class="tag">&lt;url&gt;</span>http://oss.sonatype.org/content/groups/public<span class="tag">&lt;/url&gt;</span>
  <span class="tag">&lt;/repository&gt;</span>
  <span class="tag">&lt;repository&gt;</span>
    <span class="tag">&lt;id&gt;</span>nativelibs4java-repo<span class="tag">&lt;/id&gt;</span>
    <span class="tag">&lt;name&gt;</span>NativeLibs4Java Old Snapshots Repository<span class="tag">&lt;/name&gt;</span>
    <span class="tag">&lt;url&gt;</span>http://nativelibs4java.sourceforge.net/maven<span class="tag">&lt;/url&gt;</span>
  <span class="tag">&lt;/repository&gt;</span>
<span class="tag">&lt;/repositories&gt;</span>
<span class="tag">&lt;dependencies&gt;</span>
  <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>com.nativelibs4java<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>bridj<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>0.7-SNAPSHOT<span class="tag">&lt;/version&gt;</span>
  <span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;/dependencies&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_use_with_sbt"><a class="anchor" href="#_use_with_sbt"></a>2.1.3. Use with sbt</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="scala">import sbt._

class Project(info: ProjectInfo) extends DefaultProject(info)
{
  // Repository for snapshots (0.6.2-SNAPSHOT onwards)
  // val sonatypeSnapshotsRepo = &quot;Sonatype OSS Snapshots Repository&quot; at &quot;http://oss.sonatype.org/content/groups/public&quot;
  // Repository for old releases &lt;= 0.6
  // val nativelibs4javaRepo = &quot;NativeLibs4Java Repository&quot; at &quot;http://nativelibs4java.sourceforge.net/maven/&quot;
  val bridj = &quot;com.nativelibs4java&quot; % &quot;bridj&quot; % &quot;0.7.0&quot;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_specialized_subsets_smaller_jars"><a class="anchor" href="#_specialized_subsets_smaller_jars"></a>2.1.4. Specialized subsets (smaller JARs !)</h4>
<div class="paragraph">
<p>If BridJ is too heavy for you, there are pre-packaged specialized subsets of BridJ.</p>
</div>
<div class="paragraph">
<p>You can download them manually from the <a href="http://repo1.maven.org/maven2/com/nativelibs4java/bridj/0.7.0/">Maven repository</a> or specify the correct <em>classifier</em> in the Maven dependency (cf. next section).</p>
</div>
<div class="sect4">
<h5 id="_list_of_prepackaged_subsets"><a class="anchor" href="#_list_of_prepackaged_subsets"></a>List of prepackaged subsets</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3337%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Maven Classifier</th>
<th class="tableblock halign-left valign-top">C</th>
<th class="tableblock halign-left valign-top">C++</th>
<th class="tableblock halign-left valign-top">Objective-C</th>
<th class="tableblock halign-left valign-top">COM</th>
<th class="tableblock halign-left valign-top">.NET</th>
<th class="tableblock halign-left valign-top">Windows (x86, x64)</th>
<th class="tableblock halign-left valign-top">MacOS X (universal)</th>
<th class="tableblock halign-left valign-top">iOS (arm)</th>
<th class="tableblock halign-left valign-top">Linux (x86, x64)</th>
<th class="tableblock halign-left valign-top">Solaris (x86)</th>
<th class="tableblock halign-left valign-top">Android (arm)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>empty</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>c-only</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>windows-only</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unix-only</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>linux-only</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>macosx-only</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ios-only</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>android</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_build_your_own_subset"><a class="anchor" href="#_build_your_own_subset"></a>Build your own subset</h5>
<div class="paragraph">
<p>Note that you can use the <a href="http://maven.apache.org/plugins/maven-shade-plugin/">Maven Shade Plugin</a> in your own
Maven project to strip away native libraries (in the <code>org/bridj/lib/*</code> packages) and classes (such as COM support in <code>org/bridj/cpp/com/*</code>) that you don&#8217;t need.</p>
</div>
<div class="paragraph">
<p>Take <a href="https://github.com/ochafik/nativelibs4java/tree/master/libraries/Runtime/BridJ/pom.xml">BridJ&#8217;s pom</a> as example.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_platform_notes"><a class="anchor" href="#_platform_notes"></a>2.2. Platform notes</h3>
<div class="sect3">
<h4 id="_android"><a class="anchor" href="#_android"></a>2.2.1. Android</h4>
<div class="paragraph">
<p>BridJ works partially on Android/arm emulators (with the <a href="http://developer.android.com/sdk/index.html">SDK</a>), and probably even on actual devices (untested).</p>
</div>
<div class="paragraph">
<p>Proper C++ support might require that you compile your native library with the Android NDK r5 (or more recent) or with <a href="http://www.crystax.net/android/ndk-r5.php">CrystaX&#8217;s NDK</a>, as BridJ makes some use of RTTI.</p>
</div>
<div class="paragraph">
<p>See <a href="http://code.google.com/p/nativelibs4java/issues/detail?id=69">this issue</a> for progress info.</p>
</div>
<div class="sect4">
<h5 id="_including_bridj_in_a_project"><a class="anchor" href="#_including_bridj_in_a_project"></a>Including BridJ in a project</h5>
<div class="paragraph">
<p>To include BridJ to an Android project, you have two options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using the Android SDK Eclipse plugin :</p>
<div class="ulist">
<ul>
<li>
<p>add <code>bridj-x.x-android.jar</code> to your project&#8217;s classpath</p>
</li>
<li>
<p>make sure to untick the "Force error when external jars contain native libraries" checkbox in the Eclipse / Android / Build preferences (otherwise it will complain that "The library x contains native libraries that will not run on the device.")
<span class="image"><img src="./images/eclipse-android-sdk-nativelib-error.png" alt="err"></span></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<a href="http://code.google.com/p/android/issues/detail?id=17861">this setting is broken</a> in the current version of the plugin, so as a workaround you&#8217;ll have to also untick the "Automatically refresh resources and assets folder on build" checkbox&#8230;&#8203; Annoying ? Please let the Android devs know about it ;-)
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Command-line :</p>
<div class="ulist">
<ul>
<li>
<p>build your native library with the <a href="http://developer.android.com/sdk/ndk/index.html">NDK</a></p>
</li>
<li>
<p>use an ant-based project (see sample below).</p>
</li>
<li>
<p>create the <code>lib</code> directory and put <code>bridj-x.x-android.jar</code> inside it (add any other JAR dependency there)</p>
</li>
<li>
<p>add the line <code>jar.libs.dir=lib</code> to the <code>build.properties</code> file : BridJ will be in the classpath and will be included in your program.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_sample_of_bridj_on_android"><a class="anchor" href="#_sample_of_bridj_on_android"></a>Sample of BridJ on Android</h5>
<div class="paragraph">
<p>A simple sample of BridJ use on Android was derived from the NDK&#8217;s <code>helloworld-jni</code> sample. It is <a href="https://github.com/ochafik/nativelibs4java/tree/master/libraries/Runtime/BridJ/src/main/cpp/android-test/">available in BridJ&#8217;s SVN repository</a>.</p>
</div>
<div class="paragraph">
<p>Building upon the NDK&#8217;s <code>helloworld-jni</code> sample, you can modify the helloworld.c file as follows :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="preprocessor">#include</span> <span class="include">&lt;string.h&gt;</span>
<span class="preprocessor">#include</span> <span class="include">&lt;jni.h&gt;</span>

jstring Java_com_example_hellojni_HelloJni_stringFromJNI( JNIEnv* env, jobject thiz ) {
    <span class="keyword">return</span> (*env)-&gt;NewStringUTF(env, <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello from JNI !</span><span class="delimiter">&quot;</span></span>);
}

<span class="predefined-type">int</span> addTwoInts(<span class="predefined-type">int</span> a, <span class="predefined-type">int</span> b) {
        <span class="keyword">return</span> a + b;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And add the following BridJ bindings :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.example.hellojni</span>;

<span class="keyword">import</span> <span class="include">org.bridj</span>.*;
<span class="keyword">import</span> <span class="include">org.bridj.ann</span>.*;

<span class="annotation">@Library</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello-jni</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">BridJLib</span> {
        <span class="directive">static</span> {
                BridJ.register();
        }
        <span class="directive">public</span> <span class="directive">static</span> <span class="directive">native</span> <span class="type">int</span> addTwoInts(<span class="type">int</span> a, <span class="type">int</span> b);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will then be able to use BridJ transparently in your activities :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">TextView  tv = <span class="keyword">new</span> TextView(<span class="local-variable">this</span>);
<span class="type">int</span> a = <span class="integer">10</span>, b = <span class="integer">100</span>;
tv.setText(a + <span class="string"><span class="delimiter">&quot;</span><span class="content"> + </span><span class="delimiter">&quot;</span></span> + b + <span class="string"><span class="delimiter">&quot;</span><span class="content"> = </span><span class="delimiter">&quot;</span></span> + BridJLib.addTwoInts(a, b) + <span class="string"><span class="delimiter">&quot;</span><span class="content"> (computed in BridJ-bound native function !)</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_windows"><a class="anchor" href="#_windows"></a>2.2.2. Windows</h4>
<div class="paragraph">
<p>C, C++, COM support is ok.</p>
</div>
<div class="paragraph">
<p><code>.NET</code> support is non-existent.</p>
</div>
</div>
<div class="sect3">
<h4 id="_linux"><a class="anchor" href="#_linux"></a>2.2.3. Linux</h4>
<div class="paragraph">
<p>C, C++ support is ok.</p>
</div>
</div>
<div class="sect3">
<h4 id="_solaris"><a class="anchor" href="#_solaris"></a>2.2.4. Solaris</h4>
<div class="paragraph">
<p>Only Solaris x86 is supported (test hardware would be welcome !).</p>
</div>
<div class="paragraph">
<p>C, C++ support is ok, with some issues in endianness-aware reading/writing with Pointer.</p>
</div>
</div>
<div class="sect3">
<h4 id="_macos_x"><a class="anchor" href="#_macos_x"></a>2.2.5. MacOS X</h4>
<div class="paragraph">
<p>C, C++ support is ok.</p>
</div>
<div class="paragraph">
<p>Objective-C support is dramatically undertested and probably very poor. Help would be appreciated&#8230;&#8203;</p>
</div>
</div>
<div class="sect3">
<h4 id="_ios_jailbroken_iphones_and_ipads"><a class="anchor" href="#_ios_jailbroken_iphones_and_ipads"></a>2.2.6. iOS (jailbroken iPhones and iPads)</h4>
<div class="paragraph">
<p>BridJ&#8217;s support for iOS is not working properly yet, and relies on <a href="http://jamvm.sourceforge.net/">JamVM</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_current_state"><a class="anchor" href="#_current_state"></a>3. Current State</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_working_features"><a class="anchor" href="#_working_features"></a>3.1. Working Features</h3>
<div class="ulist">
<ul>
<li>
<p>thread-safe design (including reentrant calls)</p>
</li>
<li>
<p><a href="http://jnaerator.googlecode.com/">JNAerator</a> support on par with JNA&#8217;s</p>
</li>
<li>
<p>C functions calls with <code>__cdecl</code> and <code>__stdcall</code> conventions (including varargs support)</p>
</li>
<li>
<p>C++ constructors, method calls and destructors (including virtual methods, <code><em>thiscall</code> and <code></em>stdcall</code> conventions)</p>
</li>
<li>
<p>C classes subclassing from Java (override virtual C methods from Java !)</p>
</li>
<li>
<p>lazy signatures annotation support (exact symbols are optional)</p>
</li>
<li>
<p>Call C callbacks from Java and call Java-implemented callbacks from C</p>
</li>
<li>
<p>Complete [Pointers] API (with typed opaque pointers, array accessible + iterable reified generic Pointer base class&#8230;&#8203;)</p>
</li>
<li>
<p>Type-safe enums (ValuedEnum + <a href="http://nativelibs4java.sourceforge.net/bridj/api/stable/org/bridj/FlagSet.html">FlagSet</a> classes) : unifies singleton and multi-flags patterns</p>
</li>
<li>
<p>[COM] object creation and calls, with some support for the VARIANT type</p>
</li>
<li>
<p>lightweight and fast structs (no memory duplication nor update issues between Java and the native side), with unions and sub-structs</p>
</li>
<li>
<p><a href="http://nativelibs4java.sourceforge.net/bridj/api/stable/org/bridj/jawt/JAWTUtils.html">Getting the native handler to an AWT Component&#8217;s peer</a></p>
</li>
<li>
<p>Dynamic function pointers casting (see <code>Pointer.asDynamicFunction</code>)</p>
</li>
<li>
<p>Enumeration of shared libraries symbols (w/ demangling) and resolution of libraries paths (including support for GNU LD scripts)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_known_limitations"><a class="anchor" href="#_known_limitations"></a>3.2. Known limitations</h3>
<div class="ulist">
<ul>
<li>
<p>structs by value not supported yet (neither as function arguments nor as function return values)</p>
</li>
<li>
<p>requires Java 1.5 or more recent (if you need 1.4 compatibility, you shoud JNA instead)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_features_in_progress"><a class="anchor" href="#_features_in_progress"></a>3.3. Features in progress</h3>
<div class="ulist">
<ul>
<li>
<p>assembly-optimized raw calls (for Win32, Win64, Mac64, Linux32, Linux64) : win64 is buggy, lin32 is TODO, mac is buggy with floats and doubles (of course, buggy implies disabled)</p>
</li>
<li>
<p>C++ templates for functions and classes (combination of generics and extra args/fields for types reification and last-minute lookup of actual symbols). Begins to work with GCC.</p>
</li>
<li>
<p>ObjectiveC methods calls (objc_msgSend) : hope to draw interest from Rococoa developers</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_planned_features"><a class="anchor" href="#_planned_features"></a>3.4. Planned features</h3>
<div class="paragraph">
<p>(also see <a href="#_google_summer_of_code">Google Summer of Code</a> for projects on which we&#8217;d love to receive help, from students or passionate individuals)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>pass and return structs by value</p>
</li>
<li>
<p>C++ templates typedefs : <code>typedef WImageC&lt;uchar, 1&gt;        WImage1_b;</code> (JNAerator should create WImage1_b with the correct constructor).</p>
</li>
<li>
<p>COM JNAeration : need to parse <code>__declspec(uuid("xxx"))</code></p>
</li>
<li>
<p><strong>some</strong> amount of built-in support for STL types (strings and vector at least, in debug/release mode, for GNU&#8217;s STL, STLPort and MS VC++9&#8217;s STL)</p>
</li>
<li>
<p>Full MFC Runtime (with annotations-based message map creation)</p>
</li>
<li>
<p>Mono/CLR interop (see <a href="http://ochafik.free.fr/blog/?p=165">my previous hack</a>)</p>
</li>
<li>
<p>MS/.NET interop</p>
</li>
<li>
<p>reverse-engineering helper (struct sizes guesses can be eased up a bit, and there&#8217;s already a good demangler)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_dynamic_library_dependencies"><a class="anchor" href="#_dynamic_library_dependencies"></a>3.5. Dynamic Library dependencies</h3>
<div class="paragraph">
<p>On Windows :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>C runtime + DbgHelp</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>On MacOS X :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>C runtime + libobjc + pthreads</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>On other Unix platforms :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>C runtime + pthreads</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_features_not_planned_ruled_out"><a class="anchor" href="#_features_not_planned_ruled_out"></a>3.6. Features Not Planned / Ruled Out</h3>
<div class="paragraph">
<p>Why limiting the scope of this project so early ?</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_project"><a class="anchor" href="#_project"></a>4. Project</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_design"><a class="anchor" href="#_design"></a>4.1. Design</h3>
<div class="paragraph">
<p><a href="http://jna.dev.java.net/">JNA</a> made it trivial to access to native libraries from Java.
Together with <a href="http://code.google.com/p/jnaerator/">JNAerator</a>, it effectively lowered the entry cost of native developments,
when compared to <a href="http://en.wikipedia.org/wiki/Java_Native_Interface">JNI</a>.</p>
</div>
<div class="paragraph">
<p>However, JNA was designed in the pre-Java 1.5 era and has made some design choices that hinder both performance and usability.</p>
</div>
<div class="paragraph">
<p>BridJ was written from scratch to replace JNA with both performance and usability as golden objectives (as well as support for C and ease of conversion from C to Java).</p>
</div>
<div class="paragraph">
<p>Performance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Lightweight structs : no data duplication nor synchronization issues</p>
</li>
<li>
<p>Pervasive "direct" mode (heavy use of "native" Java methods)</p>
</li>
<li>
<p>Assembler-optimized calls in some simple cases on select plaforms (see details below)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Usability :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_bridj_pointers">BridJ &amp; Pointers</a> class behaves pretty much like C pointers (automatic translation is trivial)</p>
</li>
<li>
<p><a href="#_bridj_type_mapping">BridJ &amp; Type Mapping</a>#Enums are typed while letting users combine them as flags</p>
</li>
<li>
<p><a href="#_bridj_cpp">BridJ &amp; CPP</a>: Create a C++ object with <code>new MyCPPObject()</code>, subclass it with <code>new MyCPPObject() { public void myOverriddenMethod() {} }</code>&#8230;&#8203;</p>
</li>
<li>
<p><a href="#_bridj_type_mapping">BridJ &amp; Type Mapping</a>#Structs have chainable setters : <code>new MyStruct().a(10).b(12)</code></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_assembler_optimizations"><a class="anchor" href="#_assembler_optimizations"></a>4.1.1. Assembler optimizations</h4>
<div class="paragraph">
<p>These optimization are turned on when all conditions are met, which might be rarely or never (please read <a href="http://code.google.com/p/jnaerator/wiki/Reification" class="bare">http://code.google.com/p/jnaerator/wiki/Reification</a>][for how to generate optimizable and OO-looking methods out of plain old C functions).</p>
</div>
<div class="paragraph">
<p>Without these optimizations, BridJ&#8217;s performance is about the same as JNA in direct mode (without structs, where BridJ is much faster). With the optimizations, BridJ is about 10% slower than pure JNI, that is 5x faster than JNA in direct mode.</p>
</div>
<div class="sect4">
<h5 id="_supported_cases"><a class="anchor" href="#_supported_cases"></a>Supported cases</h5>
<div class="paragraph">
<p>Concerns only the native C functions with primitive arguments that match the platform&#8217;s size.</p>
</div>
<div class="paragraph">
<p>Supports calls with a maximum number of arguments that depends on the platform (typically, 4).</p>
</div>
<div class="paragraph">
<p>Supported platforms :
  * MacOS X 64 bits
  * Linux 64 bits
  * Windows 32 bits
  * Windows 64 bits (currently disabled)</p>
</div>
</div>
<div class="sect4">
<h5 id="_examples"><a class="anchor" href="#_examples"></a>Examples</h5>
<div class="paragraph">
<p>Example of optimizable functions :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">native</span> <span class="type">int</span> f(<span class="type">long</span> a, <span class="type">short</span> b, <span class="type">int</span> c);

<span class="comment">// long primitive tagged as a pointer : optimized on 64 bits platforms only</span>
<span class="directive">public</span> <span class="directive">static</span> <span class="directive">native</span> <span class="type">int</span> fWithPointer(<span class="annotation">@Ptr</span> <span class="type">long</span> p);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Examples of non-optimizable function :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// p is not a primitive :</span>
<span class="directive">public</span> <span class="directive">static</span> <span class="directive">native</span> <span class="type">int</span> fWithPointer(Pointer&lt;?&gt; p);

<span class="comment">// most supported platforms support optimization of up to 4 arguments :</span>
<span class="directive">public</span> <span class="directive">static</span> <span class="directive">native</span> <span class="type">int</span> fTooManyArgs(<span class="type">long</span> a, <span class="type">short</span> b, <span class="type">int</span> c, <span class="type">int</span> d, <span class="type">int</span> e, <span class="type">int</span> f, <span class="type">int</span> g, <span class="type">int</span> h, <span class="type">int</span> i);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_disabling_raw_optimizations"><a class="anchor" href="#_disabling_raw_optimizations"></a>Disabling raw optimizations</h5>
<div class="paragraph">
<p>Set the environment variable <code>BRIDJ_DIRECT=0</code> or set the Java property <code>bridj.direct=false</code>.</p>
</div>
<div class="paragraph">
<p>Raw assembly optimizations are also disabled when protected mode is turned on.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bridj_pointers"><a class="anchor" href="#_bridj_pointers"></a>4.2. BridJ &amp; Pointers</h3>
<div class="sect3">
<h4 id="_anatomy_of_a_pointer"><a class="anchor" href="#_anatomy_of_a_pointer"></a>4.2.1. Anatomy of a pointer</h4>
<div class="paragraph">
<p>Please read through the <a href="http://nativelibs4java.sourceforge.net/bridj/api/stable/org/bridj/Pointer.html">Pointer class&#8217;s Javadoc</a>.</p>
</div>
<div class="paragraph">
<p>In BridJ, each pointer exposes the following data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a peer, which is the long value of the memory address it points to. It is never equal to zero (the NULL pointer is represented with the Java null value).</p>
</li>
<li>
<p>a target type, which is null for <code>Pointer&lt;?&gt;</code> instances and Integer.class for <code>Pointer&lt;Integer&gt;</code> instances.</p>
</li>
<li>
<p>a byte order (as for <a href="http://download.oracle.com/docs/cd/E17409_01/javase/6/docs/api/java/nio/ByteBuffer.html">NIO buffers</a>), which states whether data will be read from this pointer in <a href="http://en.wikipedia.org/wiki/Endianness">big endian or little endian</a> mode</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_reading_writing_data"><a class="anchor" href="#_reading_writing_data"></a>4.2.2. Reading / Writing data</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Pointer&lt;<span class="predefined-type">Integer</span>&gt; pInt = ...;
<span class="type">int</span> v = pInt.get(); <span class="comment">// generic way of getting the pointed element</span>
v = pInt.getInt();</code></pre>
</div>
</div>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect3">
<h4 id="_allocating_memory"><a class="anchor" href="#_allocating_memory"></a>4.2.3. Allocating memory</h4>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect3">
<h4 id="_wrapping_memory"><a class="anchor" href="#_wrapping_memory"></a>4.2.4. Wrapping memory</h4>
<div class="paragraph">
<p>Wrapping a direct NIO buffer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">ByteBuffer</span> b = <span class="predefined-type">ByteBuffer</span>.allocateDirect(<span class="integer">10</span>);
Pointer&lt;<span class="predefined-type">Byte</span>&gt; p = pointerToBytes(b); <span class="comment">// will keep a reference to b so it's not garbage-collected before p.</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Wrapping a raw native address (when you have no other choice):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">long</span> someAddress = ...;
Pointer&lt;?&gt; p = pointerToAddress(someAddress);
Pointer&lt;<span class="predefined-type">Integer</span>&gt; pInts = pointerToAddress(someAddress, <span class="predefined-type">Integer</span>.class); <span class="comment">// if you known the memory location contains integers</span>
Pointer&lt;MyStruct&gt; pInts = pointerToAddress(someAddress, MyStruct.class); <span class="comment">// if you known the memory location contains one or more structs</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_memory_bounds_offsets_iteration"><a class="anchor" href="#_memory_bounds_offsets_iteration"></a>4.2.5. Memory bounds, offsets, iteration</h4>
<div class="sect4">
<h5 id="_offsets"><a class="anchor" href="#_offsets"></a>Offsets</h5>
<div class="paragraph">
<p>In C, one can increment a pointer with <code>ptr++</code>. The expression <code>ptr + x</code>, where <code>x</code> is an integer, gives a pointer to the same memory location as <code>ptr</code> shifted by <code>x</code> elements.</p>
</div>
<div class="paragraph">
<p>If <code>ptr</code> is an int pointer, the address pointed by <code>ptr + 1</code> is the address pointed by <code>ptr</code> plus 4 bytes.</p>
</div>
<div class="paragraph">
<p>With BridJ, given a pointer <code>ptr</code>, one can get <code>ptr + 1</code> with <code>ptr.next(1)</code>.</p>
</div>
<div class="paragraph">
<p>The method <code>ptr.offset(1)</code> shifts the pointer by 1 byte, whereas <code>ptr.next(1)</code> shifts the pointer by 1 element (4 bytes if the target type of the pointer is Integer).</p>
</div>
<div class="paragraph">
<p>Take the following C++ code fragment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">int</span>* array = <span class="keyword">new</span> <span class="type">int</span>[<span class="integer">10</span>];
<span class="type">int</span>* ptr = array;
<span class="keyword">for</span> (<span class="type">int</span> index = <span class="integer">0</span>; index &lt; <span class="integer">10</span>; index++, ptr++)
  printf(<span class="string"><span class="delimiter">&quot;</span><span class="content">%i</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>, *ptr);
delete<span class="type">[]</span> array;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is an equivalent in Java:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.bridj.Pointer</span>.*;
...
Pointer&lt;<span class="predefined-type">Integer</span>&gt; array = allocateInts(<span class="integer">10</span>);
Pointer&lt;<span class="predefined-type">Integer</span>&gt; ptr = array;
<span class="keyword">for</span> (<span class="type">int</span> index = <span class="integer">0</span>; index &lt; <span class="integer">10</span>; index++) {
  <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">%i</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>.format(ptr.get()));
  ptr = ptr.next();
}
array.release(); <span class="comment">// optional</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that we could iterate directly on the pointer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">for</span> (<span class="type">int</span> value : array)
   <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">%i</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>.format(value));</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_bounds"><a class="anchor" href="#_bounds"></a>Bounds</h5>
<div class="paragraph">
<p>Memory allocated from Java using <code>Pointer.allocateXXX</code> and <code>Pointer.pointerToXXX</code> methods has known valid bounds.
Pointers that wrap direct NIO buffers also have known valid bounds that they take from the buffer.</p>
</div>
<div class="paragraph">
<p>Read/write operations on such "bounded" pointers are bounds-checked and throw exceptions when indexes are out of bounds:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.bridj.Pointer</span>.*;
...
allocateInt().getLong(); <span class="comment">// will throw: allocated an int = 4 bytes, reading a long = 8 bytes</span>
allocateShort(<span class="integer">3</span>).get(<span class="integer">3</span>); <span class="comment">// will throw: allocated 3 shorts, reading short at index 3</span>
allocateInts(<span class="integer">2</span>).next(<span class="integer">1</span>).get(-<span class="integer">1</span>); <span class="comment">// will not throw: allocated 2 ints, offsetting a pointer by 1 element and reading the element before (nulling the offset)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is possible to ask a pointer how many valid bytes are available from its pointed location:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Pointer&lt;<span class="predefined-type">Short</span>&gt; p = allocateShorts(<span class="integer">4</span>); <span class="comment">// allocate 4 * 2 bytes = 8 bytes</span>
<span class="predefined-type">System</span>.out.println(p.getRemainingBytes()); <span class="comment">// 8</span>
Pointer&lt;<span class="predefined-type">Short</span>&gt; p2 = p.next(); <span class="comment">// shift pointer by 1 short = 2 bytes.</span>
<span class="predefined-type">System</span>.out.println(p2.getRemainingBytes()); <span class="comment">// 6</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_iteration"><a class="anchor" href="#_iteration"></a>Iteration</h5>
<div class="paragraph">
<p>One can iterate over a pointer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Pointer&lt;<span class="predefined-type">Integer</span>&gt; pInts = pointerToInts(<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>, <span class="integer">4</span>, <span class="integer">5</span>);
<span class="keyword">for</span> (<span class="type">int</span> v : pInts)
  <span class="predefined-type">System</span>.out.println(v);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the pointer&#8217;s bounds are unknown, iteration will be infinite (until illegal memory access is attempted, which will most likely crash the JVM).</p>
</div>
<div class="paragraph">
<p>One case where we don&#8217;t know bounds yet want to iterate, though, is for C string length computation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">long</span> length = <span class="integer">0</span>;
Pointer&lt;<span class="predefined-type">Byte</span>&gt; pString = ...;
<span class="keyword">for</span> (<span class="type">byte</span> c : pString) {
    <span class="keyword">if</span> (c == <span class="integer">0</span>)
        <span class="keyword">break</span>;
    <span class="keyword">else</span>
        length++;</code></pre>
</div>
</div>
<div class="paragraph">
<p>(note that you can read a C string from a pointer with the method <a href="http://nativelibs4java.sourceforge.net/bridj/api/stable/org/bridj/Pointer.html#getCString()">Pointer.getCString()</a>)</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_typed_pointers"><a class="anchor" href="#_typed_pointers"></a>4.2.6. Typed pointers</h4>
<div class="paragraph">
<p>A typed pointer is a subclass of the <code>Pointer&lt;?&gt;</code> class that corresponds in C to some void pointer or opaque pointer typedef:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">typedef <span class="type">void</span>* HWND;
typedef struct _S* S;</code></pre>
</div>
</div>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect3">
<h4 id="_endianness"><a class="anchor" href="#_endianness"></a>4.2.7. Endianness</h4>
<div class="paragraph">
<p>With the method <a href="http://nativelibs4java.sourceforge.net/bridj/api/stable/org/bridj/Pointer.html#order(java.nio.ByteOrder)">Pointer.order(ByteOrder)</a>, it is possible to create a clone of a pointer that uses a different byte order to read and write to / from memory.</p>
</div>
</div>
<div class="sect3">
<h4 id="_casting"><a class="anchor" href="#_casting"></a>4.2.8. Casting</h4>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bridj_callbacks"><a class="anchor" href="#_bridj_callbacks"></a>4.3. BridJ &amp; Callbacks</h3>
<div class="paragraph">
<p>BridJ has full support for callbacks. You can pass a callback object to a native function allowing the library to call back to Java. You can also receive function pointers from the native code, and call into the library through it.</p>
</div>
<div class="sect3">
<h4 id="_the_callback_type"><a class="anchor" href="#_the_callback_type"></a>4.3.1. The Callback type</h4>
<div class="paragraph">
<p>A function pointer type is represented by an abstract subclass of <a href="http://nativelibs4java.sourceforge.net/bridj/api/stable/org/bridj/Callback.html">org.bridj.Callback</a> in Java code.
It has a single abstract function that mirrors the signature of the native function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">static</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">CallbackType</span> <span class="directive">extends</span> <span class="predefined-type">Callback</span>&lt;CallbackType&gt; {
  <span class="directive">public</span> <span class="directive">abstract</span> <span class="type">int</span> apply(Pointer&lt;<span class="predefined-type">Byte</span>&gt; buffer, <span class="type">int</span> length);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you receive a function pointer, it will be a <code>Pointer&lt;CallbackType&gt;</code> object; you can access the actual callback with the <code>Pointer.get()</code>
function and then call <code>apply</code>. To pass a callback to a native function, extend the abstract class, provide an implementation to the <code>apply</code> method,
and wrap instances of this callback object in a pointer using <code>Pointer.pointerTo</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CallbackType actualCallback=<span class="keyword">new</span> CallbackType() {
  <span class="directive">public</span> <span class="type">int</span> apply(Pointer&lt;<span class="predefined-type">Byte</span>&gt; buffer, <span class="type">int</span> length) {
    <span class="predefined-type">System</span>.out.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">Received %d bytes%n</span><span class="delimiter">&quot;</span></span>, length);
    <span class="keyword">return</span> <span class="integer">0</span>;
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
if the native code stores your callback, you need to make sure that the Java callback object is not garbage collected
while the native code uses it, otherwise your program will crash.
You can use <a href="http://nativelibs4java.sourceforge.net/bridj/api/stable/org/bridj/BridJ.html#protectFromGC(T)">BridJ.protectFromGC</a> and
<a href="http://nativelibs4java.sourceforge.net/bridj/api/stable/org/bridj/BridJ.html#unprotectFromGC(T)">BridJ.unprotectFromGC</a> for this purpose:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">MyLibrary.registerCallback(Pointer.pointerTo(actualCallback));
BridJ.protectFromGC(actualCallback);

<span class="comment">// when it is time to stop the native code from using the callback</span>
MyLibrary.unregisterCallback(Pointer.pointerTo(actualCallback));
BridJ.unprotectFromGC(actualCallback);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_complete_example"><a class="anchor" href="#_complete_example"></a>4.3.2. Complete example</h4>
<div class="paragraph">
<p>Native header:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">typedef</span> <span class="predefined-type">int</span> (*CallbackType)();

<span class="directive">void</span> callMe(CallbackType);
CallbackType getNativeCallback();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Java bindings (generated by <a href="http://jnaerator.googlecode.com/">JNAerator</a>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.bridj.BridJ</span>;
<span class="keyword">import</span> <span class="include">org.bridj.CRuntime</span>;
<span class="keyword">import</span> <span class="include">org.bridj.Callback</span>;
<span class="keyword">import</span> <span class="include">org.bridj.Pointer</span>;
<span class="keyword">import</span> <span class="include">org.bridj.ann.Library</span>;
<span class="keyword">import</span> <span class="include">org.bridj.ann.Runtime</span>;

<span class="annotation">@Library</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">CallbackTest</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Runtime</span>(CRuntime.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">CallbackTestLibrary</span> {
  <span class="directive">static</span> {
    BridJ.register();
  }
  <span class="directive">public</span> <span class="directive">static</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">CallbackType</span> <span class="directive">extends</span> <span class="predefined-type">Callback</span>&lt;CallbackType &gt; {
    <span class="directive">public</span> <span class="directive">abstract</span> <span class="type">int</span> apply();
  };
  <span class="directive">public</span> <span class="directive">static</span> <span class="directive">native</span> <span class="type">void</span> callMe(Pointer&lt;CallbackTestLibrary.CallbackType &gt; CallbackType1);
  <span class="directive">public</span> <span class="directive">static</span> <span class="directive">native</span> Pointer&lt;CallbackTestLibrary.CallbackType &gt; getNativeCallback();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the library:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.bridj.Pointer</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">Main</span> {

  <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) <span class="directive">throws</span> <span class="exception">Exception</span> {
    <span class="comment">// call a callback function received from the library</span>
    <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">C callback returned </span><span class="delimiter">&quot;</span></span> + CallbackTestLibrary.getNativeCallback().get().apply());

    <span class="comment">// create a callback function in Java</span>
    CallbackTestLibrary.CallbackType callback = <span class="keyword">new</span> CallbackTestLibrary.CallbackType() {
      <span class="annotation">@Override</span>
      <span class="directive">public</span> <span class="type">int</span> apply() {
        <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Java callback called</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">return</span> <span class="integer">175</span>;
      }
    };

    <span class="comment">// pass a callback function to the library</span>
    CallbackTestLibrary.callMe(Pointer.pointerTo(callback));
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Implementation of the native library:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="preprocessor">#include</span> <span class="include">&quot;CallbackTest.h&quot;</span>
<span class="preprocessor">#include</span> <span class="include">&quot;stdio.h&quot;</span>

<span class="directive">void</span> callMe(CallbackType c) {
    printf(<span class="string"><span class="delimiter">&quot;</span><span class="content">Java code returned %d</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>,c());
    fflush(stdout);
}

<span class="predefined-type">int</span> prCb() {
    printf(<span class="string"><span class="delimiter">&quot;</span><span class="content">Native function called</span><span class="char">\n</span><span class="delimiter">&quot;</span></span>);
    fflush(stdout);
    <span class="keyword">return</span> <span class="integer">56</span>;
}

CallbackType getNativeCallback() {
    <span class="keyword">return</span> &amp;prCb;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For this example the Java program prints the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Native function called
C callback returned 56
Java callback called
Java code returned 175</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_binaries_lookup"><a class="anchor" href="#_binaries_lookup"></a>4.4. Binaries lookup</h3>
<div class="sect3">
<h4 id="_external_binaries"><a class="anchor" href="#_external_binaries"></a>4.4.1. External binaries</h4>
<div class="sect4">
<h5 id="_lookup_paths"><a class="anchor" href="#_lookup_paths"></a>Lookup paths</h5>
<div class="paragraph">
<p>BridJ needs to know where to find binaries.</p>
</div>
<div class="paragraph">
<p>Depending on the platform, the following environment variables are used as lookup paths :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PATH</code> (Windows)</p>
</li>
<li>
<p><code>LD_LIBRARY_PATH</code> (Unix / Linux)</p>
</li>
<li>
<p><code>DYLD_LIBRARY_PATH</code> (Darwin / MacOS X)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following Java properties are also used :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java.library.path</code></p>
</li>
<li>
<p><code>gnu.classpath.boot.library.path</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Finally, the following paths are used :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>.</code></p>
</li>
<li>
<p><code>${java.home}/bin</code></p>
</li>
<li>
<p><code>${java.home}/../Libraries</code> on MacOS X</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additional paths can be added programmatically with <a href="http://nativelibs4java.sourceforge.net/bridj/api/stable/org/bridj/BridJ.html#addLibraryPath(java.lang.String)">BridJ.addLibraryPath</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_explicit_paths"><a class="anchor" href="#_explicit_paths"></a>Explicit paths</h5>
<div class="paragraph">
<p>For a given library with name <code>Xyz</code>, BridJ uses the environment variable <code>BRIDJ_XYZ_LIBRARY</code> or the property <code>bridj.Xyz.library</code> for explicit full path of the library binary file (beware : <em>case-sensitive</em> names !)</p>
</div>
<div class="paragraph">
<p>An explicit library file can also be set programmatically with <a href="http://nativelibs4java.sourceforge.net/bridj/api/stable/org/bridj/BridJ.html#setNativeLibraryFile(java.lang.String" class="bare">http://nativelibs4java.sourceforge.net/bridj/api/stable/org/bridj/BridJ.html#setNativeLibraryFile(java.lang.String</a>, java.io.File)[BridJ.setNativeLibraryFile].</p>
</div>
</div>
<div class="sect4">
<h5 id="_library_aliases_and_actual_name"><a class="anchor" href="#_library_aliases_and_actual_name"></a>Library aliases and actual name</h5>
<div class="paragraph">
<p>The actual name of a library might be platform-dependent.</p>
</div>
<div class="paragraph">
<p>For instance the "C" library is actually named <code>mscvrt.dll</code> on Windows. This is supported by BridJ through &lt;a href="http://nativelibs4java.sourceforge.net/bridj/api/stable/org/bridj/BridJ.html#setNativeLibraryActualName(java.lang.String, java.lang.String)"&gt;BridJ.setNativeLibraryActualName&lt;/a&gt;.</p>
</div>
<div class="paragraph">
<p>Likewise, you can define aliases for libraries with <a href="http://nativelibs4java.sourceforge.net/bridj/api/stable/org/bridj/BridJ.html#addNativeLibraryAlias(java.lang.String" class="bare">http://nativelibs4java.sourceforge.net/bridj/api/stable/org/bridj/BridJ.html#addNativeLibraryAlias(java.lang.String</a>, java.lang.String)[BridJ.addNativeLibraryAlias].</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_binaries_embedded_in_jars"><a class="anchor" href="#_binaries_embedded_in_jars"></a>4.4.2. Binaries embedded in JARs</h4>
<div class="paragraph">
<p>Embedded resources are extracted from paths of the form :</p>
</div>
<div class="paragraph">
<p><code>embeddedResourceRoot</code> / <code>platformName</code> / <code>binaryName</code></p>
</div>
<div class="paragraph">
<p>Details on each part of this path are in the following sub-sections :</p>
</div>
<div class="sect4">
<h5 id="_embedded_resource_roots"><a class="anchor" href="#_embedded_resource_roots"></a>Embedded resource roots</h5>
<div class="paragraph">
<p>Predefined embedded resource roots are <code>lib</code> and <code>org/bridj/lib</code>.</p>
</div>
<div class="paragraph">
<p>Additional resource roots can be added with <a href="http://nativelibs4java.sourceforge.net/bridj/api/stable/org/bridj/Platform.html#addEmbeddedLibraryResourceRoot(java.lang.String)">Platform.addEmbeddedLibraryResourceRoot</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_binary_names"><a class="anchor" href="#_binary_names"></a>Binary names</h5>
<div class="paragraph">
<p>Binary name for library <code>Xyz</code> will be <code>libXyz.so</code>, <code>libXyz.dylib</code>, <code>Xyz.so</code> or <code>Xyz.dll</code> depending on the platform.</p>
</div>
</div>
<div class="sect4">
<h5 id="_platform_names_and_example_resource_paths"><a class="anchor" href="#_platform_names_and_example_resource_paths"></a>Platform names and example resource paths</h5>
<div class="paragraph">
<p>Platform names are as follows :</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Platform name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Platform description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Example resource path for library <code>Xyz</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>win32</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Window x86 (32 bits)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/win32/Xyz.dll</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>win64</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Window x64 (64 bits)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/win64/Xyz.dll</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>linux_x86</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux x86 (32 bits)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/linux_x86/libXyz.so</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>linux_x64</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux amd64 (64 bits)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/linux_x64/libXyz.so</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>linux_armhf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux arm32 hard-float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/linux_armhf/libXyz.so</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sunos_x86</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Solaris x86 (32 bits)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/sunos_x86/Xyz.so</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>darwin_universal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MacOS X (x86 / x64 / ppc)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/darwin_universal/libXyz.dylib</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Please see <a href="https://github.com/ochafik/nativelibs4java/tree/master/libraries/BridJ/src/main/resources/org/bridj/lib">BridJ&#8217;s sources</a> for an up-to-date list of platform names.</p>
</div>
<div class="paragraph">
<p>The exception is Android, where the only embedded resource root is 'lib' :</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Platform name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Plarform description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Example resource path for library <code>Xyz</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>armeabi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Android arm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/armeabi/libXyz.so</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_dependent_libraries"><a class="anchor" href="#_dependent_libraries"></a>4.4.3. Dependent libraries</h4>
<div class="paragraph">
<p>If a shared library depends on another one, it may be useful to declare the dependencies upfront so that BridJ is able to extract and load them before your library:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Library</span>(value = <span class="string"><span class="delimiter">&quot;</span><span class="content">MainLib</span><span class="delimiter">&quot;</span></span>, dependencies = { <span class="string"><span class="delimiter">&quot;</span><span class="content">Dependency1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Dependency2</span><span class="delimiter">&quot;</span></span>... })</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also declare these dependencies dynamically with <a href="http://nativelibs4java.sourceforge.net/bridj/api/development/org/bridj/BridJ.html">BridJ</a>.addNativeLibraryDependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// &quot;MainLib.dll&quot; / &quot;libMainLib.so&quot; / &quot;libMainLib.dylib&quot;...</span>
<span class="annotation">@Library</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">MainLib</span><span class="delimiter">&quot;</span></span>)
<span class="type">class</span> <span class="class">MainLib</span>
    <span class="directive">static</span> {
        <span class="comment">// Ensure &quot;Dependency1/2.dll&quot; / &quot;libDependency1/2.so&quot; are loaded before &quot;MainLib.dll&quot; / &quot;libMainLib.so&quot;.</span>
        BridJ.addNativeLibraryDependencies(<span class="string"><span class="delimiter">&quot;</span><span class="content">MainLib</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Dependency1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Dependency2</span><span class="delimiter">&quot;</span></span>);
        BridJ.register();
    }
    ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jnaerator_support"><a class="anchor" href="#_jnaerator_support"></a>4.4.4. JNAerator support</h4>
<div class="paragraph">
<p>JNAerator can bundle embedded binaries for all architectures (with repeated <code>-arch</code> command-line flags) and even deal with dependent libraries (with <code>-dependencies</code> flags). See <a href="https://code.google.com/p/jnaerator/wiki/CommandLineOptionsAndEnvironmentVariables">JNAerator flags help</a>.</p>
</div>
<div class="paragraph">
<p>Also see this <a href="http://stackoverflow.com/questions/29530261/how-to-use-jnaerator-with-multiple-dynamic-libraries-under-one-header/29549769#29549769">Stack Overflow question</a> for an example of bundling cross-platform binaries (TODO expand some doc here)</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bridj_type_mapping"><a class="anchor" href="#_bridj_type_mapping"></a>4.5. BridJ &amp; Type Mapping</h3>
<div class="paragraph">
<p>If it&#8217;s a pointer, it&#8217;s a Pointer!</p>
</div>
<div class="paragraph">
<p>With BridJ, mapping was kept to its simplest form: if a type is a pointer,
it will be mapped to org.bridj.Pointer in Java (or to a subclass of it).
This is very different from JNA where there are many possible mappings for the same native type.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>C/C++</code> type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java/BridJ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JNA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int*</code>, <code>int&amp;</code>, <code>int[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Pointer&lt;Integer&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>IntegerByReference</code>, <code>Pointer</code>, <code>int[]</code>, <code>IntBuffer</code>&#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void**</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Pointer&lt;Pointer&lt;?&gt;&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PointerByReference</code>, <code>Pointer</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>wchar_t</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>char</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>char</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>struct S*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Pointer&lt;S&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>S</code>, <code>S.ByReference</code>, <code>Pointer</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>struct S</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>S</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>S.ByValue</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>enum E</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ValuedEnum&lt;E&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>const char*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Pointer&lt;Byte&gt;</code> (use getCString() to get the string)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code>, <code>Pointer</code>, <code>ByteByReference</code> , <code>ByteBuffer</code>, <code>byte[]</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note that while NIO buffers are not allowed in bindings (<code>Pointer&lt;Integer&gt;</code> must be used rather than <code>IntBuffer</code>, unlike with JNA),
it is trivial to create pointers out of buffers (see <code>Pointer.pointerToBuffer(Buffer)</code>, <code>Pointer.pointerToInts(IntBuffer)</code>&#8230;&#8203;) and the other way around (<code>Pointer.getBuffer()</code>, <code>Pointer.getIntBuffer()</code>&#8230;&#8203;).</p>
</div>
<div class="paragraph">
<p>Please make sure to also read the <a href="#_faq">FAQ</a>.</p>
</div>
<div class="sect3">
<h4 id="_structs"><a class="anchor" href="#_structs"></a>4.5.1. Structs</h4>
<div class="paragraph">
<p>BridJ structs were designed to be performant and easy to use.</p>
</div>
<div class="paragraph">
<p>Using <a href="http://code.google.com/p/jnaerator/">JNAerator</a> to create them out of C definitions is strongly advised.</p>
</div>
<div class="paragraph">
<p>C code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c"><span class="keyword">struct</span> S {
     <span class="predefined-type">int</span> a;
     <span class="directive">void</span>* p;
};

<span class="directive">void</span> funVal(<span class="keyword">struct</span> S byVal);
<span class="keyword">struct</span> S myStruct;
<span class="keyword">struct</span> S* pS = &amp;myStruct;
funVal(myStruct);
funVal(*myStruct);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Equivalent Java/BridJ code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Generated by JNAerator:</span>
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">S</span> <span class="directive">extends</span> StructObject {
        <span class="directive">public</span> S() { <span class="local-variable">super</span>(); }
        <span class="directive">public</span> S(Pointer pointer) { <span class="local-variable">super</span>(pointer); }
        <span class="annotation">@Field</span>(<span class="integer">0</span>)
        <span class="directive">public</span> <span class="type">int</span> a() {
                <span class="keyword">return</span> <span class="local-variable">this</span>.io.getIntField(<span class="local-variable">this</span>, <span class="integer">0</span>);
        }
        <span class="comment">// BridJ setters return this to allow invocation chaining</span>
        <span class="annotation">@Field</span>(<span class="integer">0</span>)
        <span class="directive">public</span> S a(<span class="type">int</span> a) {
                <span class="local-variable">this</span>.io.setIntField(<span class="local-variable">this</span>, <span class="integer">0</span>, a);
                <span class="keyword">return</span> <span class="local-variable">this</span>;
        }
        <span class="annotation">@Field</span>(<span class="integer">1</span>)
        <span class="directive">public</span> Pointer&lt;? &gt; p() {
                <span class="keyword">return</span> <span class="local-variable">this</span>.io.getPointerField(<span class="local-variable">this</span>, <span class="integer">1</span>, ?.class);
        }
        <span class="annotation">@Field</span>(<span class="integer">1</span>)
        <span class="directive">public</span> S p(Pointer&lt;? &gt; p) {
                <span class="local-variable">this</span>.io.setPointerField(<span class="local-variable">this</span>, <span class="integer">1</span>, p);
                <span class="keyword">return</span> <span class="local-variable">this</span>;
        }
};

<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.bridj.Pointer</span>.*;

S myStruct = <span class="keyword">new</span> S(); <span class="comment">// maybe chained with setters: new S().a(10).b(12).c(55);</span>
Pointer&lt;S&gt; pS = pointerTo(myStruct);
funVal(myStruct);
funVal(pS.get()); <span class="comment">// pointer is a reified generic class, so get() returns a correct S instance</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_enums"><a class="anchor" href="#_enums"></a>4.5.2. Enums</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c"><span class="keyword">typedef</span> <span class="keyword">enum</span> SimpleEnum {
        First = <span class="integer">0</span>,
        Second = <span class="integer">10</span>,
        Last = <span class="integer">11</span>
} SimpleEnum;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Enums don&#8217;t mean the same in Java and C/C++.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In Java, an enum item is a singleton subclass of the enum class. It has no associated value besides its index within the list of enum items but is a real class and can implement interfaces and define new fields / methods</p>
</li>
<li>
<p>In C/C, enums are just typed integers (in C they&#8217;re not restricted to int), so you can combine them with bitwise operators <code>&amp;</code>, <code>|</code>, <code>^</code>, <code>!</code>&#8230;&#8203;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This means that we&#8217;d like to benefit from the enum / singleton Java pattern and still be able to pass multiple values to C code expecting enums.</p>
</div>
<div class="paragraph">
<p>In BridJ, this is made possible with the <code>ValuedEnum&lt;E&gt;</code> interface (and <code>IntValuedEnum&lt;E&gt;</code> subinterface):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Generated by JNAerator:</span>
<span class="directive">public</span> <span class="type">enum</span> SimpleEnum <span class="directive">implements</span> IntValuedEnum&lt;SimpleEnum &gt; {
        First(<span class="integer">0</span>),
        Second(<span class="integer">10</span>),
        Last(<span class="integer">11</span>);
        SimpleEnum(<span class="type">long</span> value) {
                <span class="local-variable">this</span>.value = value;
        }
        <span class="directive">public</span> <span class="directive">final</span> <span class="type">long</span> value;
        <span class="directive">public</span> <span class="type">long</span> value() {
                <span class="keyword">return</span> <span class="local-variable">this</span>.value;
        }
        <span class="directive">public</span> <span class="predefined-type">Iterator</span>&lt;SimpleEnum &gt; iterator() {
                <span class="keyword">return</span> <span class="predefined-type">Collections</span>.singleton(<span class="local-variable">this</span>).iterator();
        }
        <span class="directive">public</span> <span class="directive">static</span> IntValuedEnum&lt;SimpleEnum &gt; fromValue(<span class="type">int</span> value) {
                <span class="keyword">return</span> FlagSet.fromValue(value, values());
        }
};
<span class="directive">public</span> <span class="directive">static</span> <span class="directive">native</span> <span class="type">void</span> doSomething(IntValuedEnum&lt;SimpleEnum&gt; value);

<span class="keyword">import</span> <span class="include">static</span> <span class="include">SimpleEnum</span>.*;
<span class="directive">public</span> <span class="type">void</span> test {
        doSomething(First);

        <span class="comment">// Pass ORed flags: 'First | Value'</span>
        doSomething(SimpleEnum.fromValue(First.value() | Second.value()));
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_callbacks"><a class="anchor" href="#_callbacks"></a>4.5.3. Callbacks</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> performTask(<span class="directive">void</span>(*monitor)(<span class="predefined-type">int</span> currentProgress));</code></pre>
</div>
</div>
<div class="paragraph">
<p>BridJ equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// Generated by JNAerator:</span>
<span class="directive">public</span> <span class="directive">static</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">performTask_monitor_callback</span> <span class="directive">extends</span> <span class="predefined-type">Callback</span>&lt;performTask_monitor_callback &gt; {
    <span class="directive">public</span> <span class="directive">abstract</span> <span class="type">void</span> apply(<span class="type">int</span> currentProgress);
};
<span class="directive">public</span> <span class="directive">static</span> <span class="directive">native</span> <span class="type">void</span> performTask(Pointer&lt;CallbackTestLibrary.performTask_monitor_callback &gt; arg);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For further details, see <a href="#_bridj_callbacks">BridJ &amp; Callbacks</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_c_class"><a class="anchor" href="#_c_class"></a>4.5.4. C++ Class</h4>
<div class="paragraph">
<p>C++ code (compiled in test.dll / libtest.dylib / test.so):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="keyword">class</span> <span class="class">MyClass</span> {
<span class="directive">public</span>:
    <span class="directive">virtual</span> ~MyClass();
    <span class="predefined-type">int</span> someMethod();
    <span class="directive">virtual</span> <span class="predefined-type">int</span> someVirtualMethod();
};
<span class="directive">void</span> test() {
    MyClass inst;
    inst.someMethod();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>BridJ equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Example</span> {
        <span class="comment">// Generated by JNAerator:</span>
        <span class="annotation">@Library</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>)
        <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">MyClass</span> <span class="directive">extends</span> CPPObject {
                <span class="directive">public</span> MyClass() { <span class="local-variable">super</span>(); }
                <span class="directive">public</span> MyClass(Pointer pointer) { <span class="local-variable">super</span>(pointer);        }
                <span class="annotation">@Virtual</span>(<span class="integer">0</span>)
                <span class="directive">public</span> <span class="directive">native</span> <span class="type">void</span> MyClassDestructor();
                <span class="directive">public</span> <span class="directive">native</span> <span class="type">int</span> someMethod();
                <span class="annotation">@Virtual</span>(<span class="integer">1</span>)
                <span class="directive">public</span> <span class="directive">native</span> <span class="type">int</span> someVirtualMethod();
        };
        <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> test() {
                MyClass inst = <span class="keyword">new</span> MyClass();
                inst.someMethod();
        }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_backwards_compatibility"><a class="anchor" href="#_backwards_compatibility"></a>4.6. Backwards compatibility</h3>
<div class="paragraph">
<p>BridJ is still a young project and its API is bound to evolve still a lot before version 1.0 is out.</p>
</div>
<div class="paragraph">
<p>However, most of its features are already usable (and used) in production, so backwards compatibility is a growing concern for our users.</p>
</div>
<div class="sect3">
<h4 id="_note_on_dependencies"><a class="anchor" href="#_note_on_dependencies"></a>4.6.1. Note on dependencies</h4>
<div class="paragraph">
<p>BridJ has very few dependencies.</p>
</div>
<div class="paragraph">
<p>Amongst them, ASM was <a href="https://github.com/ochafik/nativelibs4java/issues/272">reported not to be backwards-compatible</a>, so in BridJ its packages have been relocated from <code>org.objectweb.asm.<strong></code> to <code>org.bridj.relocated.org.objectweb.asm.</strong></code>.</p>
</div>
<div class="paragraph">
<p>If the same issue was ever to come up with another dependency of BridJ, please <a href="https://github.com/ochafik/nativelibs4java/issues/new">let us know</a> and we&#8217;ll sort it out ASAP !</p>
</div>
</div>
<div class="sect3">
<h4 id="_bridj_s_pre_1_0_api_a_moving_target"><a class="anchor" href="#_bridj_s_pre_1_0_api_a_moving_target"></a>4.6.2. BridJ&#8217;s pre-1.0 API: a moving target</h4>
<div class="paragraph">
<p>In order to improve the usability of BridJ&#8217;s API (and sometimes to support new features), some backwards-incompatible changes have been made in past versions and might be done in future ones.</p>
</div>
<div class="sect4">
<h5 id="_example_of_past_api_breaking_change"><a class="anchor" href="#_example_of_past_api_breaking_change"></a>Example of past API breaking change</h5>
<div class="paragraph">
<p>An example of such breaking change is the methods <code>Pointer.getInt(long)</code> (respectively <code>getLong</code>, <code>getShort</code>&#8230;&#8203;) that were renamed to <code>Pointer.getIntAtOffset(long)</code> (resp. <code>getLongAtOffset</code>, <code>getShortAtOffset</code>&#8230;&#8203;).</p>
</div>
<div class="paragraph">
<p>This change was done to avoid inevitable confusion between <code>Pointer&lt;Integer&gt;.get(long)</code> which argument is expressed in number of integers, and <code>Pointer&lt;Integer&gt;.getInt(long)</code> which argument was expressed in number of bytes : this behaviour is now explicit in the name of the new <code>Pointer&lt;Integer&gt;.getIntAtOffset(long)</code>, avoiding lots of head-scratching from future users and cutting support costs down.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_what_if_you_need_backwards_compatibility_from_bridj"><a class="anchor" href="#_what_if_you_need_backwards_compatibility_from_bridj"></a>4.6.3. What if you need backwards-compatibility from BridJ ?</h4>
<div class="paragraph">
<p>These backwards-incompatible changes can however become a huge issue for users whose libraries are likely to coexist in the same applications with other BridJ-dependent libraries that use different versions of BridJ.</p>
</div>
<div class="sect4">
<h5 id="_bridj_s_version_specific_repackaged_artifact"><a class="anchor" href="#_bridj_s_version_specific_repackaged_artifact"></a>BridJ&#8217;s version-specific repackaged artifact</h5>
<div class="paragraph">
<p><strong>This is a feature still in development, should be stable by the release of 0.7</strong>.</p>
</div>
<div class="paragraph">
<p>BridJ now has an experimental version-specific packaged artifact available with the "version-specific-packages" classifier :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">  <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>com.nativelibs4java<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>bridj<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>0.7-SNAPSHOT<span class="tag">&lt;/version&gt;</span>
        <span class="tag">&lt;classifier&gt;</span>version-specific-packages<span class="tag">&lt;/classifier&gt;</span>
  <span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this artifact, the <code>org.bridj</code> package is renamed to <code>org.bridj.v0_7</code> : this requires an update of all the import clauses in client source code but guarantees there won&#8217;t be any version collision with other versions of BridJ in the classpath.</p>
</div>
</div>
<div class="sect4">
<h5 id="_maven_based_workaround"><a class="anchor" href="#_maven_based_workaround"></a>Maven-based workaround</h5>
<div class="paragraph">
<p>If you need a different classifier from BridJ (say, "c-only"), we advise you to relocate BridJ&#8217;s packages yourself with the <a href="http://maven.apache.org/plugins/maven-shade-plugin/index.html">Maven Shade Plugin</a> using a configuration such as the following :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;build&gt;</span>
    <span class="tag">&lt;plugins&gt;</span>
            <span class="tag">&lt;plugin&gt;</span>
                    <span class="tag">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
                        <span class="tag">&lt;artifactId&gt;</span>maven-shade-plugin<span class="tag">&lt;/artifactId&gt;</span>
                        <span class="tag">&lt;version&gt;</span>1.4<span class="tag">&lt;/version&gt;</span>
                        <span class="tag">&lt;configuration&gt;</span>
                                <span class="tag">&lt;relocations&gt;</span>
                                        <span class="tag">&lt;relocation&gt;</span>
                                                <span class="tag">&lt;pattern&gt;</span>org.bridj<span class="tag">&lt;/pattern&gt;</span>
                                                <span class="tag">&lt;shadedPattern&gt;</span>org.bridj.v0_7<span class="tag">&lt;/shadedPattern&gt;</span>
                                        <span class="tag">&lt;/relocation&gt;</span>
                                <span class="tag">&lt;/relocations&gt;</span>
                        <span class="tag">&lt;/configuration&gt;</span>
                <span class="tag">&lt;/plugin&gt;</span>
        <span class="tag">&lt;/plugins&gt;</span>
<span class="tag">&lt;/build&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_language_specific"><a class="anchor" href="#_language_specific"></a>5. Language Specific</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_bridj_cpp"><a class="anchor" href="#_bridj_cpp"></a>5.1. BridJ &amp; CPP</h3>
<div class="paragraph">
<p>Also read <a href="#_current_state">Current State</a> and <a href="#_bridj_type_mapping">BridJ &amp; Type Mapping</a> for more details.</p>
</div>
<div class="sect3">
<h4 id="_example_of_c_class"><a class="anchor" href="#_example_of_c_class"></a>5.1.1. Example of C++ class</h4>
<div class="paragraph">
<p>Let&#8217;s use the following C++ class throughout this page :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="preprocessor">#ifdef</span> _WIN32
<span class="preprocessor">#    ifdef</span> TEST_EXPORTS
<span class="preprocessor">#        define</span> TEST_API __declspec(dllexport)
<span class="preprocessor">#    else</span>
<span class="preprocessor">#        define</span> TEST_API __declspec(dllimport)
<span class="preprocessor">#    endif</span>
<span class="preprocessor">#elseif</span>
<span class="preprocessor">#    define</span> TEST_API
<span class="preprocessor">#endif</span>

<span class="keyword">class</span> <span class="class">TEST_API</span> TestClass {
<span class="directive">public</span>:
    <span class="directive">virtual</span> ~TestClass();
    <span class="directive">virtual</span> <span class="predefined-type">int</span> testVirtualAdd(<span class="predefined-type">int</span> a, <span class="predefined-type">int</span> b);
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Its BridJ bindings are easy to write, but it is advised to use <a href="http://code.google.com/p/jnaerator/">JNAerator</a> to create them, nevertheless :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.bridj</span>.*;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.bridj.Pointer</span>.*;

<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TestClass</span> <span class="directive">extends</span> CPPObject {
        <span class="annotation">@Virtual</span>(<span class="integer">0</span>)
        <span class="directive">public</span> <span class="directive">native</span> <span class="type">int</span> testVirtualAdd(<span class="type">int</span> a, <span class="type">int</span> b);
};</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_runtime_support"><a class="anchor" href="#_runtime_support"></a>5.1.2. Runtime support</h4>
<div class="sect4">
<h5 id="_supported_compilers"><a class="anchor" href="#_supported_compilers"></a>Supported compilers</h5>
<div class="ulist">
<ul>
<li>
<p>GCC 4.x (&amp; Intel C++ Compiler)</p>
</li>
<li>
<p>Visual C++ 9.0</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_supported_platforms"><a class="anchor" href="#_supported_platforms"></a>Supported platforms</h5>
<div class="paragraph">
<p>All of BridJ&#8217;s supported platforms (see [CurrentState]).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_language_support"><a class="anchor" href="#_language_support"></a>5.1.3. Language support</h4>
<div class="sect4">
<h5 id="_supported_features"><a class="anchor" href="#_supported_features"></a>Supported features</h5>
<div class="ulist">
<ul>
<li>
<p>Creating C++ class instances :</p>
<div class="literalblock">
<div class="content">
<pre>TestClass test = new TestClass();
Pointer&lt;TestClass&gt; pTest = pointerTo(test);</pre>
</div>
</div>
</li>
<li>
<p>Calling C++ methods (including virtual and static ones, varargs) :</p>
<div class="literalblock">
<div class="content">
<pre>int result = test.testVirtualAdd(1, 2);</pre>
</div>
</div>
</li>
<li>
<p>Experimental support for C++ class templates (JNAerator is not yet compatible with this feature, so you&#8217;ll have to write the template bindings by hand for now ; see <a href="https://github.com/ochafik/nativelibs4java/tree/master/libraries/Runtime/BridJ/src/test/java/org/bridj/CPPTemplateTest.java">CPPTemplateTest</a>)</p>
</li>
<li>
<p>Subclassing C++ classes from Java, with virtual methods overrides :
And you can now derive from <code>TestClass</code> in Java very naturally :</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">TestClass test = <span class="keyword">new</span> TestClass() {
        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="type">int</span> testVirtualAdd(<span class="type">int</span> a, <span class="type">int</span> b) {
                <span class="keyword">return</span> a + b;
        }
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>The only known limitation so far is that you cannot call super.testVirtualAdd from the overridden method yet (but this is worked on and should be possible in the next release).</p>
</div>
</div>
<div class="sect4">
<h5 id="_features_not_supported"><a class="anchor" href="#_features_not_supported"></a>Features not supported</h5>
<div class="ulist">
<ul>
<li>
<p>Exceptions !</p>
</li>
<li>
<p>Multiple inheritance</p>
</li>
<li>
<p>Virtual inheritance (not to be confused with virtual methods, which <strong>are</strong> supported)</p>
</li>
<li>
<p>Function and method templates (only class templates are (partially) supported for now)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bridj_c"><a class="anchor" href="#_bridj_c"></a>5.2. BridJ &amp; C</h3>
<div class="paragraph">
<p>Please see <a href="#_current_state">Current State</a>.</p>
</div>
<div class="paragraph">
<p>BridJ supports functions, callbacks (Java to native, native to java), enums, pointers, structs, globals&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>See <a href="#_bridj_type_mapping">BridJ &amp; Type Mapping</a> for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="_bridj_scala"><a class="anchor" href="#_bridj_scala"></a>5.3. BridJ &amp; Scala</h3>
<div class="paragraph">
<p>BridJ was designed with JNAerator in mind, so that you never have to translate any C / C++ / ObjectiveC header by hand.</p>
</div>
<div class="paragraph">
<p>JNAerator creates Java sources or classes, that can then be used seamlessly from Scala.</p>
</div>
<div class="paragraph">
<p>However, BridJ has some Scala-specific features in its core classes, and JNAerator has Scala-specific generation modes.</p>
</div>
<div class="paragraph">
<p>This page details these Scala-oriented features.</p>
</div>
<div class="sect3">
<h4 id="_pointer"><a class="anchor" href="#_pointer"></a>5.3.1. Pointer</h4>
<div class="paragraph">
<p><a href="http://nativelibs4java.sourceforge.net/bridj/api/stable/org/bridj/Pointer.html">BridJ&#8217;s pointer class</a> was designed to behave
like a list, so provided you import <code>scala.collection.JavaConversions._</code> you&#8217;ll be able to iterate over its pointed elements.</p>
</div>
<div class="paragraph">
<p>It also implements apply and update, so indexed access can be made with the natural Scala syntax :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>val value = pointer(index)
pointer(index) = value</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>C code
that demonstrates multi-dimensional arrays declarations and usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c"><span class="predefined-type">float</span> array1d[<span class="integer">100</span>];
<span class="predefined-type">float</span> array2d[<span class="integer">100</span>][<span class="integer">200</span>];
<span class="predefined-type">float</span> array3d[<span class="integer">100</span>][<span class="integer">200</span>][<span class="integer">300</span>];

<span class="predefined-type">float</span> v1 = array1d[<span class="integer">10</span>];
<span class="predefined-type">float</span> v2 = array2d[<span class="integer">10</span>][<span class="integer">20</span>];
<span class="predefined-type">float</span> v3 = array3d[<span class="integer">10</span>][<span class="integer">20</span>][<span class="integer">30</span>];
array3d[<span class="integer">10</span>][<span class="integer">20</span>][<span class="integer">30</span>] = v1 + v2 + v3;</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Scala code :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="scala">import org.bridj.Pointer._

val array1d = allocateFloats(100)
val array2d = allocateFloats(100, 200)
val array3d = allocateFloats(100, 200, 300)

val v1 = array1d(10)
val v2 = array2d(10)(20)
val v3 = array3d(10)(20)(30)
array3d(10)(20)(30) = v1 + v2 + v3</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Java code :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.bridj.Pointer</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.bridj.Pointer</span>.*;
...
Pointer&lt;<span class="predefined-type">Float</span>&gt;
        array1d = allocateFloats(<span class="integer">100</span>);

Pointer&lt;Pointer&lt;<span class="predefined-type">Float</span>&gt;&gt;
        array2d = allocateFloats(<span class="integer">100</span>, <span class="integer">200</span>);

Pointer&lt;Pointer&lt;Pointer&lt;<span class="predefined-type">Float</span>&gt;&gt;&gt;
        array3d = allocateFloats(<span class="integer">100</span>, <span class="integer">200</span>, <span class="integer">300</span>);

<span class="type">float</span> v1 = array1d.get(<span class="integer">10</span>);
<span class="type">float</span> v2 = array2d.get(<span class="integer">10</span>).get(<span class="integer">20</span>);
<span class="type">float</span> v3 = array3d.get(<span class="integer">10</span>).get(<span class="integer">20</span>).get(<span class="integer">30</span>);
array3d.get(<span class="integer">10</span>).get(<span class="integer">20</span>).set(<span class="integer">30</span>, v1 + v2 + v3);</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_structs_2"><a class="anchor" href="#_structs_2"></a>5.3.2. Structs</h4>
<div class="paragraph">
<p>When using <a href="http://code.google.com/p/jnaerator/">JNAerator</a> to create BridJ structs, you can use the <code>-scalaSetters</code> switch to generate setters in the form <code>MyStruct.myField_=</code> that are treated like setters by Scala.</p>
</div>
<div class="paragraph">
<p>These setters do not replace the usual generated setters, they&#8217;re final and just call the usual setters.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>C struct and code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c"><span class="keyword">typedef</span> <span class="keyword">struct</span> S {
    <span class="predefined-type">int</span> a;
    <span class="predefined-type">double</span> d;
} S;

S s;
s.a = <span class="integer">10</span>;
s.d = <span class="integer">1</span><span class="float">0</span><span class="float">.0</span>;</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Scala code :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="scala">val s = (new S).a(10).d(10.0)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Scala code (using setters) :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="scala">val s = new S
s.a = 10
s.d = 10.0</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Java code :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">S s = <span class="keyword">new</span> S().a(<span class="integer">10</span>).d(<span class="float">10.0</span>)</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_com"><a class="anchor" href="#_com"></a>5.4. COM</h3>
<div class="paragraph">
<p>COM defines interfaces and registers implementations of these interfaceS.</p>
</div>
<div class="paragraph">
<p>Interfaces are identified by their IID, and implementations are registered in the COM runtime using their CLSID.</p>
</div>
<div class="paragraph">
<p>In most cases with BridJ you don&#8217;t need to know more about COM internals.</p>
</div>
<div class="sect3">
<h4 id="_example"><a class="anchor" href="#_example"></a>5.4.1. Example</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@IID</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">56FDF342-FD6D-11D0-958A-006097C9A090</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ITaskbarList</span> <span class="directive">extends</span> IUnknown {

        <span class="annotation">@Virtual</span>(<span class="integer">0</span>) <span class="directive">public</span> <span class="directive">native</span> <span class="type">void</span> HrInit();
        <span class="annotation">@Virtual</span>(<span class="integer">1</span>) <span class="directive">public</span> <span class="directive">native</span> <span class="type">void</span> AddTab(Pointer&lt;<span class="predefined-type">Integer</span>&gt; hWnd);
        <span class="annotation">@Virtual</span>(<span class="integer">2</span>) <span class="directive">public</span> <span class="directive">native</span> <span class="type">void</span> DeleteTab(Pointer&lt;<span class="predefined-type">Integer</span>&gt; hWnd);
        <span class="annotation">@Virtual</span>(<span class="integer">3</span>) <span class="directive">public</span> <span class="directive">native</span> <span class="type">void</span> ActivateTab(Pointer&lt;<span class="predefined-type">Integer</span>&gt; hWnd);
        <span class="annotation">@Virtual</span>(<span class="integer">4</span>) <span class="directive">public</span> <span class="directive">native</span> <span class="type">void</span> SetActiveAlt(Pointer&lt;<span class="predefined-type">Integer</span>&gt; hWnd);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://github.com/ochafik/nativelibs4java/tree/master/libraries/Runtime/BridJ/src/main/java/org/bridj/cpp/com/shell/ITaskbarList3.java">ITaskbarList3 interface</a></p>
</div>
<div class="paragraph">
<p><a href="https://github.com/ochafik/nativelibs4java/blob/master/libraries/Runtime/BridJ/src/main/demos/TaskbarListDemo.java">See a complete example here</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_who_s_using_bridj"><a class="anchor" href="#_who_s_using_bridj"></a>6. Who&#8217;s using BridJ</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Please keep in mind that <a href="#_credits_and_license">Credits and License</a> BridJ is licensed under the BSD license, so anyone using it must state it appropriately in the documentation and/or other distributed materials (but there&#8217;s no need to publish any modified sources, although it is good practice ;-)).</p>
</div>
<div class="paragraph">
<p>Here are some of the projects known to use BridJ internally (please post <a href="http://groups.google.com/group/nativelibs4java">on the mailing list</a> if you&#8217;d like your project to be listed here):</p>
</div>
<div class="sect2">
<h3 id="_stormmq_myxi"><a class="anchor" href="#_stormmq_myxi"></a>6.1. StormMQ Myxi</h3>
<div class="paragraph">
<p><a href="http://stormmq.com/">StormMQ Myxi</a> is the world&#8217;s first Message Queue as a Service using AMQP 1-0.</p>
</div>
<div class="paragraph">
<p>We decided to use BridJ as it is the only professionally-supported, efficient product available today to seamlessly integrate essential C functionality with Java. Olivier Chafik, the main developer, provides first-class support and deep technical understanding.</p>
</div>
<div class="paragraph">
<p>We&#8217;ve successfully mapped gnu libc and libpthread to allow us more fidelity and functionality on linux and work round Java&#8217;s limitations with memory mapped files. "</p>
</div>
</div>
<div class="sect2">
<h3 id="_directx4java"><a class="anchor" href="#_directx4java"></a>6.2. directx4java</h3>
<div class="paragraph">
<p><a href="http://code.google.com/p/directx4java/">DirectX4Java</a> is a port of DirectX 10 and 11 for Java (MIT-licensed) written by <a href="https://www.masterbranch.com/developer/evandro.millian">Evandro Millian</a>.</p>
</div>
<div class="paragraph">
<p>It recently switched from JNA to BridJ to power its low-level COM interoperability.</p>
</div>
</div>
<div class="sect2">
<h3 id="_jlibav"><a class="anchor" href="#_jlibav"></a>6.3. jlibav</h3>
<div class="paragraph">
<p><a href="http://code.google.com/p/jlibav/">Java wrapper for Libav</a>.</p>
</div>
<div class="paragraph">
<p>This library provides an access to a big part of the Libav functions via BridJ. It is compatible with all Libav binaries since version 0.7. The goal of this project is to cover complete functionality of the Libav.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the Libav binaries are not a part of this library
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_openimaj"><a class="anchor" href="#_openimaj"></a>6.4. OpenIMAJ</h3>
<div class="paragraph">
<p><a href="http://www.openimaj.org/">Open Intelligent Multimedia Analysis toolkit for Java</a> (OpenIMAJ, BSD-licensed) is a collection
of libraries for multimedia analysis, focusing on state of the art and highly scalable (multithreaded + distributed)
image analysis and feature extraction. It was written by <a href="mailto:jsh2@ecs.soton.ac.uk">Jon Hare</a>,
<a href="mailto:ss@ecs.soton.ac.uk">Sina Samangooei</a> and <a href="mailto:dpd@ecs.soton.ac.uk">David Dupplaw</a>.</p>
</div>
<div class="paragraph">
<p>It uses BridJ in its 'openimaj-serial-driver' and 'core-video-capture' modules.</p>
</div>
</div>
<div class="sect2">
<h3 id="_webcam_capture"><a class="anchor" href="#_webcam_capture"></a>6.5. webcam-capture</h3>
<div class="paragraph">
<p><a href="http://webcam-capture.sarxos.pl/">sarxos/webcam-capture</a> is a generic Webcam capture utility (cross-platform, multi-drivers).</p>
</div>
<div class="paragraph">
<p>It uses BridJ for its built-in drivers.</p>
</div>
</div>
<div class="sect2">
<h3 id="_hunspell_bridj"><a class="anchor" href="#_hunspell_bridj"></a>6.6. hunspell-bridj</h3>
<div class="paragraph">
<p><a href="https://github.com/thomas-joiner/HunspellBridJ">HunspellBridJ</a>: bindings for the Hunspell library for Java, using BridJ.</p>
</div>
</div>
<div class="sect2">
<h3 id="_bridj_pcap"><a class="anchor" href="#_bridj_pcap"></a>6.7. BridJ PCap</h3>
<div class="paragraph">
<p><a href="http://os.smaxe.com/bridj-pcap.html">BridJ PCap</a> (LGPL-licensed) is a library written by <a href="http://andreisochirca.blogspot.com/">Andrei Sochirca</a> that provides network packet capture functionality.</p>
</div>
<div class="paragraph">
<p>It uses BridJ to leverage the native install of <a href="http://www.tcpdump.org/">libpcap</a> or <a href="http://www.winpcap.org/">WinPCap</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="__code_geotools_code"><a class="anchor" href="#__code_geotools_code"></a>6.8. <code>GeoTools</code></h3>
<div class="paragraph">
<p><a href="http://www.geotools.org/">GeoTools</a> is an open source Java library that provides tools for geospatial data.</p>
</div>
<div class="paragraph">
<p>It uses BridJ to bind the <a href="http://www.gdal.org/ogr/">OGR</a> library.</p>
</div>
</div>
<div class="sect2">
<h3 id="_falplayer_android_j"><a class="anchor" href="#_falplayer_android_j"></a>6.9. falplayer-android-j</h3>
<div class="paragraph">
<p><a href="https://github.com/atsushieno/falplayer-android-j">falplayer-android-j</a> (MIT-licensed) is the Java version of <a href="https://github.com/atsushieno">Atsushi Eno</a>'s Ogg Vorbis music player for Android (see original version : <a href="https://github.com/atsushieno/falplayer-android">falplayer</a>).</p>
</div>
<div class="paragraph">
<p>It features BridJ-powered libvorbisidec / <a href="http://wss.co.uk/pinknoise/tremolo/">Tremolo</a> bindings.</p>
</div>
</div>
<div class="sect2">
<h3 id="_javacl"><a class="anchor" href="#_javacl"></a>6.10. JavaCL</h3>
<div class="paragraph">
<p><a href="http://code.google.com/p/javacl/">JavaCL</a> (BSD-licensed) is an <a href="http://www.khronos.org/opencl/">OpenCL</a> bindings library for Java.</p>
</div>
<div class="paragraph">
<p>It switched to BridJ for its low-level bindings (legacy JNA version is still available for download).</p>
</div>
<div class="paragraph">
<p><a href="http://code.google.com/p/javacl/wiki/WhoUsesJavaCL">JavaCL is also used by other projects</a>, which hence make indirect use of BridJ.</p>
</div>
</div>
<div class="sect2">
<h3 id="_scalacl"><a class="anchor" href="#_scalacl"></a>6.11. ScalaCL</h3>
<div class="paragraph">
<p><a href="http://code.google.com/p/scalacl/">ScalaCL</a> (BSD-licensed) is an optimizing Scala compiler plugin + GPU-backed collections.</p>
</div>
<div class="paragraph">
<p>It uses the BridJ port of JavaCL.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contributing_to_bridj"><a class="anchor" href="#_contributing_to_bridj"></a>7. Contributing to BridJ</h2>
<div class="sectionbody">
<div class="paragraph">
<p>BridJ now has <a href="#_credits_and_license">some contributors</a> as well as <a href="https://github.com/ochafik/nativelibs4java/issues">many bug reporters</a>.</p>
</div>
<div class="paragraph">
<p>Any further help will be highly welcome !</p>
</div>
<div class="paragraph">
<p>You can help in many ways :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>report bugs</p>
</li>
<li>
<p>suggest / write documentation</p>
</li>
<li>
<p>investigate <a href="https://github.com/ochafik/nativelibs4java/issues">open bugs</a></p>
</li>
<li>
<p>submit patches / pull requests for fixes or new features</p>
</li>
<li>
<p>help users on the <a href="http://groups.google.com/group/nativelibs4java">mailing list</a> or on StackOverflow</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you wish to contribute code, you&#8217;ll want to have a look at the <a href="#_build">Build</a> page.</p>
</div>
<div class="paragraph">
<p>In any case if you don&#8217;t know where to start, please ask on the <a href="http://groups.google.com/group/nativelibs4java">mailing list</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_help"><a class="anchor" href="#_how_to_help"></a>8. How to help</h2>
<div class="sectionbody">
<div class="paragraph">
<p>BridJ is an ambitious project that aims at becoming the ultimate free interop library for Java (free as in freedom and beer : [CreditsAndLicense BSD-licensed]).</p>
</div>
<div class="paragraph">
<p>BridJ and JNAerator are mainly developed by a <a href="http://ochafik.com">single individual</a> but they also have a handful of occasional committers and received [CreditsAndLicense many contributions] in the form of bug reports and suggestions.</p>
</div>
<div class="paragraph">
<p>Even if you&#8217;re not a programmer you&#8217;re welcome to contribute to these projects, and we&#8217;ll be happy to help you with your contribution.</p>
</div>
<div class="paragraph">
<p>This page details some ways you can help us.</p>
</div>
<div class="paragraph">
<p>If any item rings a bell,
<a href="http://groups.google.fr/group/nativelibs4java">let&#8217;s discuss it</a>.</p>
</div>
<div class="sect2">
<h3 id="_new_projects"><a class="anchor" href="#_new_projects"></a>8.1. New projects</h3>
<div class="paragraph">
<p>See <a href="#_google_summer_of_code">Google Summer of Code</a> for details on some ambitious sub-project that will likely not see the light of day without your help.</p>
</div>
</div>
<div class="sect2">
<h3 id="_bug_fixes_and_enhancements"><a class="anchor" href="#_bug_fixes_and_enhancements"></a>8.2. Bug Fixes and Enhancements</h3>
<div class="paragraph">
<p>There are <a href="#_submitting_bugs">many issues</a>, just waiting for you.</p>
</div>
</div>
<div class="sect2">
<h3 id="_graphics"><a class="anchor" href="#_graphics"></a>8.3. Graphics</h3>
<div class="paragraph">
<p>BridJ has no icon, JNAerator neither.</p>
</div>
<div class="paragraph">
<p>Feel like changing that ?</p>
</div>
</div>
<div class="sect2">
<h3 id="_money_or_hardware_donations"><a class="anchor" href="#_money_or_hardware_donations"></a>8.4. Money or Hardware donations</h3>
<div class="paragraph">
<p>BridJ is developped, debugged and built on different CPU architectures and different operating systems (Windows 32/64, Linux x86/x64, MacOS x86/x64/ppc).</p>
</div>
<div class="paragraph">
<p>What refrains me from porting it to Solaris (sparcv8, sparcv9) or FreeBSD is I don&#8217;t have the appropriate hardware and / or system administration knowledge. If you do, please help by sending me hardware and / or advice.</p>
</div>
<div class="paragraph">
<p>In the case of hardware lending, I can guarantee return of the hardware if we negociate the associated costs.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="http://sourceforge.net/donate/index.php?group_id=266856"><img src="http://images.sourceforge.net/images/project-support.jpg" alt="donate" width="88" height="32"></a>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_submitting_bugs"><a class="anchor" href="#_submitting_bugs"></a>9. Submitting Bugs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you face what appears to be a bug in BridJ, [CreditsAndLicense we]'d be very grateful if you could try and report it on the bug tracker :
  <a href="https://github.com/ochafik/nativelibs4java/issues?labels=BridJ">NativeLibs4Java&#8217;s BridJ Bug Tracker</a></p>
</div>
<div class="paragraph">
<p>Of course, <a href="#_credits_and_license">we</a>'d recommend that you first look at the open bugs (and if you&#8217;re not using the latest snapshot version of BridJ, that you also look at the bugs recently closed) to see if an issue similar to yours has already been reported.</p>
</div>
<div class="paragraph">
<p>Please use <a href="https://github.com/ochafik/nativelibs4java/issues?sort=created&amp;direction=desc&amp;state=open">NativeLibs4Java&#8217;s GitHub Issues</a> to report bugs and request enhancements with a title starting by <code>BridJ: &#8230;&#8203;</code></p>
</div>
<div class="sect2">
<h3 id="_what_should_go_in_an_ideal_report"><a class="anchor" href="#_what_should_go_in_an_ideal_report"></a>9.1. What should go in an ideal report</h3>
<div class="paragraph">
<p>To maximise the chances <a href="#_credits_and_license">we</a> can fix the issue and/or help you quickly, please make sure to provide all of the following items in the report :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Minimum-sized working code that exhibits the issue : <strong>any of the following</strong> :</p>
<div class="ulist">
<ul>
<li>
<p>a class with a static main method that compiles directly against BridJ&#8217;s JAR (you might want to <a href="#_build">Build</a> and just drop your <code>.java</code> file to <code>src/main/java</code>, to have it compiled an run with <code>mvn compile exec:java -Dexec.mainClass=yourClass</code>)</p>
</li>
<li>
<p>a JUnit test class that can just be dropped into <a href="https://github.com/ochafik/nativelibs4java/tree/master/libraries/Runtime/BridJ/src/test/java/org/bridj">BridJ&#8217;s test sources</a></p>
</li>
<li>
<p>an archive of a project that compiles <strong>easily</strong> with Maven or Ant
<em>In particular, please make sure to include the source code of your BridJ bindings.</em> If you&#8217;ve used <a href="http://code.google.com/p/jnaerator/">JNAerator</a> without the <a href="http://code.google.com/p/jnaerator/wiki/CommandLineOptionsAndEnvironmentVariables">-noComp and -noJar options</a>, the sources of the generated bindings are located in the generated JAR, alongside the .class files.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Instructions on how to run your code :</p>
<div class="ulist">
<ul>
<li>
<p>full command-line</p>
</li>
<li>
<p>prequisites :</p>
<div class="ulist">
<ul>
<li>
<p>native library to install manually ?</p>
</li>
<li>
<p>specific hardware ?</p>
</li>
<li>
<p>other dependencies (direct links and/or exact version numbers, please !)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>The full error log of BridJ :</p>
<div class="ulist">
<ul>
<li>
<p>Set the <code>BRIDJ_VERY_VERBOSE=1</code> environment variable prior to running your program / test class</p>
</li>
<li>
<p>Any <code>hs_err_pidXXX.log</code> files</p>
</li>
<li>
<p>In case the program never ends (hangs with no normal reason), run <code>jconsole</code> and include a dump of the execution trace of the main thread (or of all of them)</p>
</li>
</ul>
</div>
</li>
<li>
<p>A direct link to the native library targeted by your bindings, if possible and if needed to reproduce the issue</p>
</li>
<li>
<p>The full C/C++/Objective-C headers of the native library</p>
</li>
<li>
<p>The exact <a href="http://code.google.com/p/jnaerator/">JNAerator</a> arguments you&#8217;ve used to generate your bindings, if you&#8217;ve used that tool (which is highly advised !)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also, please do not use fancy archive formats (stick to plain old <code>.zip</code>), and if you have only a handful of files without particular directory hierarchy, you can even attach these files separately (this way they&#8217;ll be readable separately from an iPhone).</p>
</div>
<div class="paragraph">
<p>Anyway if you&#8217;re in doubt, please come and ask on <a href="http://groups.google.com/group/nativelibs4java">the mailing-list</a> :-)</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_google_summer_of_code"><a class="anchor" href="#_google_summer_of_code"></a>10. Google Summer of Code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>BridJ is a young project that opens many doors in the Java interop world, but exploring all these doors will require a lot of help.</p>
</div>
<div class="paragraph">
<p>We describe here some of the projects on which we would love to mentor students or passionate individuals,
should they be sponsored through the <a href="http://code.google.com/intl/fr/soc/">Google Summer of Code</a> program or not.</p>
</div>
<div class="paragraph">
<p>Please also see the [CurrentState] page for a list of features either in progress or planned, and the [HowToHelp] for
more general ideas on how to help the BridJ / NativeLibs4Java / JNAerator projects.</p>
</div>
<div class="sect2">
<h3 id="_objective_c_support"><a class="anchor" href="#_objective_c_support"></a>10.1. Objective-C support</h3>
<div class="paragraph">
<p>BridJ currently does not have any working Objective-C support.</p>
</div>
<div class="paragraph">
<p>The <a href="http://code.google.com/p/rococoa/">Rococoa</a> project did an awesome job of binding the Objective-C runtime, building on JNA.</p>
</div>
<div class="paragraph">
<p>It would be feasible to do the same with BridJ (i.e. do a port of Rococoa from JNA to BridJ), but BridJ itself will need
some work (it might not be dynamic enough).</p>
</div>
</div>
<div class="sect2">
<h3 id="_library_interceptor_generator"><a class="anchor" href="#_library_interceptor_generator"></a>10.2. Library interceptor generator</h3>
<div class="paragraph">
<p>Library calls interception is a (hacking) technique that consists in hooking to all the calls to a existing function from a shared library.
This allows for logging, behaviour altering, etc&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>There are some system-dependent dynamic approaches, but here we could provide a static approach : we could generate a shared
library (or generate the code to compile and link such a library) that would "shadow" the actual library (would appear first on the path),
would expose the same public symbols and would actually call Java callbacks for each function, letting the function decide to call the actual
library or just handle the call the way it wants.</p>
</div>
<div class="paragraph">
<p>This internship would require writing a code generator based on JNAerator.</p>
</div>
<div class="paragraph">
<p>Possible steps :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>test this technique using a test library and a test hand-written shadow library.
Forward the calls to Java using JNI and validate the approach</p>
</li>
<li>
<p>get used to JNAerator&#8217;s internals, write code generation engine to create the shadow definitions</p>
</li>
<li>
<p>use the excellent <a href="http://dyncall.org">Dyncall</a> native cross-platform build scripts (used by BridJ) to make the compilation of generated shadow
libraries very easy (or even automatic, provided that the necessary build tools are detected locally)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Final result :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>java -jar shadow.jar mydll.dll</pre>
</div>
</div>
<div class="paragraph">
<p>Will output <code>shadow\mydll.dll</code> and <code>shadow\mydll.jar</code> : the JAR contains the hook interfaces and structure definitions in the <code>org.bridj.shadow.mydll</code> package, and the DLL should be put in the path before the actual DLL (but the actuall DLL must also be present in the path, so the shadow DLL can call it).</p>
</div>
<div class="paragraph">
<p>Setting the <code>-Dorg.bridj.shadow=log</code> Java property will install a logging hooks that will output logging data with function name, argument values (including dump of structures if applicable), return values, timestamp&#8230;&#8203;</p>
</div>
</div>
<div class="sect2">
<h3 id="_jna_to_bridj_converter"><a class="anchor" href="#_jna_to_bridj_converter"></a>10.3. JNA to BridJ Converter</h3>
<div class="paragraph">
<p>Using the <a href="http://www.jarvana.com/jarvana/view/org/eclipse/jdt/doc/isv/3.2.1-r321_v20060907/isv-3.2.1-r321_v20060907.jar!/reference/api/org/eclipse/jdt/core/dom/AST.html">Eclipse compiler API</a>
(also see <a href="http://publib.boulder.ibm.com/infocenter/iadthelp/v6r0/index.jsp?topic=/org.eclipse.jdt.doc.isv/guide/jdt_api_manip.htm">here</a>), one could create a Java code converter between JNA and BridJ client code to <strong>convert existing JNA bindings to BridJ bindings</strong> (please note that with JNAerator it is trivial to create BridJ bindings from scratch, though).</p>
</div>
<div class="paragraph">
<p>As JNA does not use generics and BridJ does, some amount of type inference will be needed,
and in general pattern matching on the Java DOM will be used.</p>
</div>
<div class="paragraph">
<p>The code rewrite logic could be generalized, maybe using a Scala DSL or some sort of rewrite template matching / replacement grammar.</p>
</div>
</div>
<div class="sect2">
<h3 id="_bridj_net"><a class="anchor" href="#_bridj_net"></a>10.4. BridJ / .NET</h3>
<div class="paragraph">
<p>A Java to Mono proof-of-concept binding <a href="http://ochafik.free.fr/blog/?p=165">was done some while ago, using the Mono C API</a>.</p>
</div>
<div class="paragraph">
<p>Here, we&#8217;re targetting the Microsoft .NET runtime, which does not have such a clean C API. Hence, we need to write one :-)</p>
</div>
<div class="paragraph">
<p>Using the BridJ modular architecture, the ultimate goal is to have C# / CLR classes that look and behave like Java classes, including with respect to subclassing.</p>
</div>
<div class="paragraph">
<p>Dark points are around mixed GC interaction (GC from the JVM vs. .NET GC), crossed inheritance and bridge performance.</p>
</div>
<div class="paragraph">
<p>The <a href="http://asm.ow2.org/">Java ASM</a> and <a href="http://msdn.microsoft.com/en-us/library/system.reflection.emit.aspx">.NET Emit</a> frameworks will also be put to high use.</p>
</div>
</div>
<div class="sect2">
<h3 id="_c_to_java_converter_started"><a class="anchor" href="#_c_to_java_converter_started"></a>10.5. C++ to Java Converter (STARTED)</h3>
<div class="paragraph">
<p>JNAerator converts C / C++ signatures to Java bindings.</p>
</div>
<div class="paragraph">
<p>The next step is to also convert the code (not only the signatures), so that one can bind a whole
library and convert all of its samples and demos directly to Java / BridJ.</p>
</div>
<div class="paragraph">
<p>The JNAerator parser will require fixes to support the C / C++ syntax completely, and some pattern matching on its DOM will be needed to convert to proper Java / BridJ constructs.</p>
</div>
<div class="paragraph">
<p><strong>WORK HAS BEGUN, WITH AMAZING RESULTS&#8230;&#8203; STAY TUNED !</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="_new_c_jvm_language"><a class="anchor" href="#_new_c_jvm_language"></a>10.6. New C++ / JVM Language</h3>
<div class="paragraph">
<p>This is a other approach to the C++ / Java interoperability problem.</p>
</div>
<div class="paragraph">
<p>On the model of Microsoft&#8217;s <a href="http://en.wikipedia.org/wiki/C%2B%2B/CLI" class="bare">http://en.wikipedia.org/wiki/C%2B%2B/CLI</a>[C/CLI language], which retains full
C compatibility while adding support for .NET/CLR objects manipulation, one could add JVM objects creation to C++.</p>
</div>
<div class="paragraph">
<p>This is a big project that can be split in more than one internships.</p>
</div>
<div class="paragraph">
<p>Here are its milestones :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add support for the C/CLI syntax subset needed to manipulate JVM objects (for instance, supporting the out or ref C/CLI keywords makes no sense) to JNAerator or LLVM (one could even JNAerate bindings for LLVM so as to pilot it from Java)</p>
</li>
<li>
<p>Create a code generator that will read the C/JVM code and output two files : one with pure C code (to be then compiled with GCC or Microsoft Visual C using dyncall's build scripts) and one with pure Java code. The pure C code will call the Java code using JNI.</p>
</li>
<li>
<p>Create line mappings between the original code and the generated code (both in Java and in C), use ASM to alter the Java code and insert "fake" line information that traces back to the original C / JVM files, so that debuggers can follow the code execution in the original files.</p>
</li>
<li>
<p>Plug into Visual C's debugger API and into GDB to provide a Java Debugging API implementation that will allow mixt debugging : stepping into both native and Java code, as what Microsoft provides with C/CLI.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As Java has no value types (besides primitives), we could even allow the dot notation to be used instead of the arrow notation when calling methods or referencing fields of Java references.</p>
</div>
<div class="paragraph">
<p>Using some or all of the <a href="http://en.wikipedia.org/wiki/C%2B%2B0x">C++0x&#8217;s new syntaxes</a> (such as the <a href="http://en.wikipedia.org/wiki/C%2B%2B0x#Type_inference">new auto keyword</a> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">using</span> <span class="keyword">namespace</span> java::util;
<span class="directive">using</span> <span class="keyword">namespace</span> java::io;
<span class="directive">using</span> <span class="keyword">namespace</span> java::lang;

List&lt;String^&gt;^ GetNames() {
    List&lt;String^&gt;^ list = gcnew List&lt;String^&gt;();
    list-&gt;add(gcnew String(<span class="string"><span class="delimiter">&quot;</span><span class="content">First</span><span class="delimiter">&quot;</span></span>));
    list-&gt;add(gcnew String(<span class="string"><span class="delimiter">&quot;</span><span class="content">Second</span><span class="delimiter">&quot;</span></span>));
    list-&gt;add(gcnew String(<span class="string"><span class="delimiter">&quot;</span><span class="content">Third</span><span class="delimiter">&quot;</span></span>));
    <span class="keyword">for</span> each (String^ s in list) {
        System::out-&gt;println(s);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_add_fortran_support"><a class="anchor" href="#_add_fortran_support"></a>10.7. Add Fortran support</h3>
<div class="paragraph">
<p>Fortran has different official versions (F77, F90&#8230;&#8203;) many compilers (each supporting its own Fortran feature set) and presumably different calling conventions.</p>
</div>
<div class="paragraph">
<p>Calling Fortran to Java might hence not be trivial.</p>
</div>
<div class="paragraph">
<p>As for C++, one should restrict the scope of the project to the most common compiler(s), say GNU Fortran (gfortran).</p>
</div>
<div class="paragraph">
<p>Support for the most common Fortran types is also important, and an excellent deliverable would be a fully functional binding to a Fortran LAPACK library from Java (there are already tons of such libraries, but I believe they&#8217;re either translated to C or have C wrappers).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_build"><a class="anchor" href="#_build"></a>11. Build</h2>
<div class="sectionbody">
<div class="paragraph">
<p>BridJ is built as part of the NativeLibs4Java sub-projects.</p>
</div>
<div class="sect2">
<h3 id="_build_bridj_only"><a class="anchor" href="#_build_bridj_only"></a>11.1. Build BridJ only</h3>
<div class="paragraph">
<p>This section will guide you through the build of BridJ.</p>
</div>
<div class="paragraph">
<p>If you start hacking it (wanna fix <a href="https://github.com/ochafik/nativelibs4java/issues?labels=BridJ">some bugs</a>?), you might also want to read the next sections about how to build other NativeLibs4Java projects that depend on BridJ, and how to rebuild BridJ&#8217;s native libraries.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First, <a href="http://maven.apache.org/download.html">install Maven 3.x</a></p>
</li>
<li>
<p>Please make sure you&#8217;ve set the git <a href="http://help.github.com/line-endings/">autocrlf option</a> to true :</p>
<div class="literalblock">
<div class="content">
<pre>git config --global core.autocrlf true</pre>
</div>
</div>
</li>
<li>
<p>Fork and/or clone the <a href="https://github.com/ochafik/nativelibs4java">NativeLibs4Java Github repository</a></p>
<div class="literalblock">
<div class="content">
<pre>git clone git://github.com/ochafik/nativelibs4java.git</pre>
</div>
</div>
</li>
<li>
<p>Go to the libraries/BridJ folder :</p>
<div class="literalblock">
<div class="content">
<pre>cd nativelibs4java
cd libraries
cd BridJ</pre>
</div>
</div>
</li>
<li>
<p>Run the following Maven command :</p>
<div class="literalblock">
<div class="content">
<pre>mvn clean install -DskipTests</pre>
</div>
</div>
</li>
<li>
<p><em>Optional</em>: You can also rebuild BridJ&#8217;s native libraries (libbridj.so / .dylib / .dll and libtest.so / .dylib / .dll) : see instructions below</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>BridJ&#8217;s JARs are in <code>Bridj/target</code> (pick <code>bridj-x.x-SNAPSHOT.jar</code> if you don&#8217;t have specific size needs).</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3337%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JAR File</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C++</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Objective-C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">COM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MFC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.NET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows (x86, x64)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MacOS X (universal)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux (x86, x64)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Solaris (x86)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Android (arm)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bridj-x.x-SNAPSHOT.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bridj-x.x-SNAPSHOT-c-only.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bridj-x.x-SNAPSHOT-windows-only.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bridj-x.x-SNAPSHOT-unix-only.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bridj-x.x-SNAPSHOT-linux-only.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bridj-x.x-SNAPSHOT-macosx-only.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bridj-x.x-SNAPSHOT-android.jar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_build_all_nativelibs4java_projects"><a class="anchor" href="#_build_all_nativelibs4java_projects"></a>11.2. Build all NativeLibs4Java projects</h3>
<div class="paragraph">
<p>BridJ is a key part of the NativeLibs4Java ecosystem, so if you start modifying it you might cause regressions in various other projects.</p>
</div>
<div class="paragraph">
<p>The good news is that some of these projects are in the same source tree as BridJ itself and you can build them and run all of their tests at the same time, so you&#8217;ll have much better confidence in your changes.</p>
</div>
<div class="paragraph">
<p>If it is the first time you ever build all of NativeLibs4Java&#8217;s projects (including JNAerator, JavaCL, ScalaCL&#8230;&#8203;), this might take can take up to 15 minutes (enough time to dring a coffee or two), since Maven has to download (and cache) lots of stuff (subsequent builds will be much quicker).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First, <a href="http://maven.apache.org/download.html">install Maven 3.x</a></p>
</li>
<li>
<p>Install JOGL on your system as <a href="http://code.google.com/p/javacl/wiki/Usage#Jogamp_JOGL">described on JavaCL&#8217;s wiki</a></p>
</li>
<li>
<p>Please make sure you&#8217;ve set the git <a href="http://help.github.com/line-endings/">autocrlf option</a> to true :</p>
<div class="literalblock">
<div class="content">
<pre>git config --global core.autocrlf true</pre>
</div>
</div>
</li>
<li>
<p>Fork and/or clone the <a href="https://github.com/ochafik/nativelibs4java">NativeLibs4Java Github repository</a></p>
<div class="literalblock">
<div class="content">
<pre>git clone git://github.com/ochafik/nativelibs4java.git</pre>
</div>
</div>
</li>
<li>
<p>Go to the libraries folder :</p>
<div class="literalblock">
<div class="content">
<pre>cd nativelibs4java/libraries</pre>
</div>
</div>
</li>
<li>
<p>Run the following Maven command :</p>
<div class="literalblock">
<div class="content">
<pre>mvn install -DskipTests</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_rebuilding_bridj_s_native_library"><a class="anchor" href="#_rebuilding_bridj_s_native_library"></a>11.3. Rebuilding BridJ&#8217;s native library</h3>
<div class="paragraph">
<p>You&#8217;ll need to rebuild BridJ&#8217;s native libraries if :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You changed any source file in <code>BridJ/src/main/cpp/bridj</code> or <code>BridJ/src/test/cpp/test</code></p>
</li>
<li>
<p>You&#8217;re trying to run BridJ on an unsupported platform</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the latter case, be brave but things should go fine in <em>most</em> cases, thanks to the extreme portability of the <a href="http://dyncall.org/">Dyncall</a> library (which BridJ uses for it&#8217;s low-level FFI and for its pretty cool build scripts).</p>
</div>
<div class="sect3">
<h4 id="_patch_dyncall"><a class="anchor" href="#_patch_dyncall"></a>11.3.1. Patch dyncall</h4>
<div class="paragraph">
<p>BridJ depends on <a href="http://dyncall.org">Dyncall</a>, so you&#8217;ll need to check it out and apply some BridJ-specific patches (beware: <code>DYNCALL_HOME</code> must point to the dyncall directory inside the dyncall directory the following command checks out) :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd BridJ
admin/checkout_and_patch_dyncall.sh dyncall
export DYNCALL_HOME=dyncall</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can do things more manually if the <code>checkout_and_patch_dyncall.sh</code> script doesn&#8217;t work for you :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>svn co https://dyncall.org/svn/dyncall/trunk dyncall
export DYNCALL_HOME=pathToDyncall/dyncall
cd dyncall
patch &lt; pathToBridJ/src/main/cpp/bridj/dyncall.diff</pre>
</div>
</div>
<div class="paragraph">
<p>You may need to clean the patch up for it to apply correctly. Also note that during some build process below dyncall.diff might be overwritten. To get the original patch in the source tree, run this :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>git checkout pathToBridJ/src/main/cpp/bridj/dyncall.diff</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_build_the_library"><a class="anchor" href="#_build_the_library"></a>11.3.2. Build the library</h4>
<div class="paragraph">
<p>Then you can build BridJ&#8217;s shared library (and its test library) :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On Unix/Linux/MacOS X :</p>
<div class="literalblock">
<div class="content">
<pre>cd BridJ
sh CleanNative ; sh BuildNative</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>(to build the native library in debug mode, use : <code>DEBUG=1 ./CleanNative ; DEBUG=1 ./BuildNative</code>)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On Windows (you can double-click on both scripts from Windows explorer instead of using the command line) :</p>
<div class="literalblock">
<div class="content">
<pre>cd BridJ
CleanNative
BuildNative</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>(to build the native library in debug mode, use : <code>BuildNative_Debug</code>)</p>
</div>
<div class="paragraph">
<p>If it&#8217;s not a platform already supported by BridJ, you must :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>update BridJ&#8217;s Java machinery so it can find your binary at runtime (search for <code>getEmbeddedLibraryResource</code> in <a href="https://github.com/ochafik/nativelibs4java/blob/master/libraries/BridJ/src/main/java/org/bridj/Platform.java">Platform.java</a>)</p>
</li>
<li>
<p>in case the build fails : update dyncall&#8217;s configure script and/or update BridJ&#8217;s <a href="https://github.com/ochafik/nativelibs4java/blob/master/libraries/BridJ/src/main/cpp/bridj/Make.sh">Make.sh</a> script</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To run the tests on your new binary :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn test</pre>
</div>
</div>
<div class="paragraph">
<p>And finally you can install the updated BridJ library locally to use it from depending projects :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn install</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_about_bridj_s_source_code"><a class="anchor" href="#_about_bridj_s_source_code"></a>11.4. About BridJ&#8217;s source code</h3>
<div class="paragraph">
<p>BridJ contains Java and C code.</p>
</div>
<div class="paragraph">
<p>Some of its sources are autogenerated from Velocity templates. For instance, all the Pointer.getInt, .setInt, getFloat, .setFloat&#8230;&#8203; are generated automatically from a template.</p>
</div>
<div class="paragraph">
<p>So if you look for Pointer.java and JNI.java, they&#8217;re not directly in the source control : they&#8217;re created during the Maven build from their template located in <code>src/main/velocity</code>.</p>
</div>
<div class="paragraph">
<p>Likewise, some test classes are autogenerated, which helps cover more cases with less code (there&#8217;s even autogenerated C functions in the test library, that are matched by the corresponding autogenerated test cases on the Java side).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bridj_s_automated_tests"><a class="anchor" href="#_bridj_s_automated_tests"></a>12. BridJ&#8217;s Automated Tests</h2>
<div class="sectionbody">
<div class="paragraph">
<p>BridJ has grown big and there are many things to test.</p>
</div>
<div class="paragraph">
<p>If you [Build build BridJ from sources], you can run a given test <code>MyTest</code> with <code>mvn test -Dtest=MyTest</code>.</p>
</div>
<div class="sect2">
<h3 id="__code_pointertest_code_and_code_typedpointerstest_code"><a class="anchor" href="#__code_pointertest_code_and_code_typedpointerstest_code"></a>12.1. <code>PointerTest</code> and <code>TypedPointersTest</code></h3>
<div class="paragraph">
<p>These tests target <code>Pointer</code>, <code>PointerIO</code> and <code>CommonPointerIOs</code> classes.</p>
</div>
<div class="paragraph">
<p><code>PointerTest</code> is generated out of a Velocity template that iterates on all BridJ primitives (java primitives + <code>CLong</code> + <code>SizeT</code> + <code>Pointer</code>) to make sure that all method variations in <code>Pointer</code> are covered.</p>
</div>
<div class="paragraph">
<p>TODO:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>more tests with non-null byteOffset !</p>
</li>
<li>
<p>fix 3D arrays</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="__code_structtest_code"><a class="anchor" href="#__code_structtest_code"></a>12.2. <code>StructTest</code></h3>
<div class="paragraph">
<p>Trivial test on simple structs.</p>
</div>
<div class="paragraph">
<p>TODO:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>more tests !</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="__code_objctest_code"><a class="anchor" href="#__code_objctest_code"></a>12.3. <code>ObjCTest</code></h3>
<div class="paragraph">
<p>Not functional !</p>
</div>
</div>
<div class="sect2">
<h3 id="__code_miscbugstest_code"><a class="anchor" href="#__code_miscbugstest_code"></a>12.4. <code>MiscBugsTest</code></h3>
<div class="paragraph">
<p>Tests that specifically target some past or present bugs.</p>
</div>
</div>
<div class="sect2">
<h3 id="__code_functiontest_code"><a class="anchor" href="#__code_functiontest_code"></a>12.5. <code>FunctionTest</code></h3>
<div class="paragraph">
<p>Trivial enum argument calls.</p>
</div>
<div class="paragraph">
<p>TODO:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>more tests !</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="__code_demanglingtest_code"><a class="anchor" href="#__code_demanglingtest_code"></a>12.6. <code>DemanglingTest</code></h3>
<div class="paragraph">
<p>Test GCC4 and VC9 C++ demanglers (given known mangled names, check we get back the expected signature).</p>
</div>
<div class="paragraph">
<p>TODO:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>more tests, especially for VC9 !</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="__code_cpptest_code"><a class="anchor" href="#__code_cpptest_code"></a>12.7. <code>CPPTest</code></h3>
<div class="paragraph">
<p>Basic C++ calls tests, including virtual vs. non-virtual calls, different calling conventions on supported platforms (__stdcall&#8230;&#8203;), destructor (including virtual destructor), static methods&#8230;&#8203;</p>
</div>
</div>
<div class="sect2">
<h3 id="__code_comtest_code"><a class="anchor" href="#__code_comtest_code"></a>12.8. <code>COMTest</code></h3>
<div class="paragraph">
<p>Windows-only test, just makes sure COM initializes well and that some known interface is instantiable.</p>
</div>
<div class="paragraph">
<p>TODO:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>more tests !!!</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="__code_comparisontest_code"><a class="anchor" href="#__code_comparisontest_code"></a>12.9. <code>ComparisonTest</code></h3>
<div class="paragraph">
<p>Compares performance of BridJ against JNA and Javolution :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Makes sure BridJ structs are one or two orders of magnitude faster that JNA structs for some operations (cast, creation&#8230;&#8203;), and faster in all cases.</p>
</li>
<li>
<p>Compare calls of simple functions with JNA in direct and indirect modes and make sure BridJ is between 2-3x faster than JNA&#8217;s direct mode and 20-30x faster than JNA&#8217;s indirect mode.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="__code_callbacktest_code"><a class="anchor" href="#__code_callbacktest_code"></a>12.10. <code>CallbackTest</code></h3>
<div class="paragraph">
<p>Test basic Java to C and C to Java callbacks.</p>
</div>
</div>
<div class="sect2">
<h3 id="__code_bridjtest_code"><a class="anchor" href="#__code_bridjtest_code"></a>12.11. <code>BridJTest</code></h3>
<div class="paragraph">
<p>Make sure BridJ is able to extract symbols from its native library</p>
</div>
</div>
<div class="sect2">
<h3 id="__code_calltest_code"><a class="anchor" href="#__code_calltest_code"></a>12.12. <code>CallTest</code></h3>
<div class="paragraph">
<p>Template-generated test that has two parts : a native C++ file, compiled in libtest.so / test.dll / libtest.dylib, and a Java class that binds to the generated functions defined in the native test library.</p>
</div>
<div class="paragraph">
<p>Makes sure the generated functions return what we expect (result based on input arguments, varying their types thanks to the template).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_coverage"><a class="anchor" href="#_test_coverage"></a>13. Test Coverage</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_running_cobertura"><a class="anchor" href="#_running_cobertura"></a>13.1. Running Cobertura</h3>
<div class="paragraph">
<p>It&#8217;s easy to create a test coverage report by yourself if you [Build build BridJ from sources] :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn cobertura:cobertura site</pre>
</div>
</div>
<div class="paragraph">
<p>The coverage report is then in <code>target/site/cobertura</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_last_published_cobertura_reports"><a class="anchor" href="#_last_published_cobertura_reports"></a>13.2. Last published Cobertura reports</h3>
<div class="paragraph">
<p>Every once in a while, we publish test coverage reports of the development version of BridJ.
If you want up-to-date reports, you should rather build BridJ from sources and look at the preceding section.</p>
</div>
<div class="paragraph">
<p><a href="http://nativelibs4java.sourceforge.net/sites/nl4j-runtime-parent/bridj/cobertura/">BridJ&#8217;s Latest Published Cobertura Report</a></p>
</div>
<div class="paragraph">
<p>Quick links within this report :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://nativelibs4java.sourceforge.net/sites/nl4j-runtime-parent/bridj/cobertura/org.bridj.Pointer.html">Pointer</a></p>
</li>
<li>
<p><a href="http://nativelibs4java.sourceforge.net/sites/nl4j-runtime-parent/bridj/cobertura/org.bridj.PointerIO.html">PointerIO</a></p>
</li>
<li>
<p><a href="http://nativelibs4java.sourceforge.net/sites/nl4j-runtime-parent/bridj/cobertura/org.bridj.CommonPointerIOs.html">CommonPointerIOs</a></p>
</li>
<li>
<p><a href="http://nativelibs4java.sourceforge.net/sites/nl4j-runtime-parent/bridj/cobertura/org.bridj.BridJ.html">BridJ</a></p>
</li>
<li>
<p><a href="http://nativelibs4java.sourceforge.net/sites/nl4j-runtime-parent/bridj/cobertura/org.bridj.CRuntime.html">CRuntime</a></p>
</li>
<li>
<p><a href="http://nativelibs4java.sourceforge.net/sites/nl4j-runtime-parent/bridj/cobertura/org.bridj.cpp.CPPRuntime.html">CPPRuntime</a></p>
</li>
<li>
<p><a href="http://nativelibs4java.sourceforge.net/sites/nl4j-runtime-parent/bridj/cobertura/org.bridj.MethodCallInfo.html">MethodCallInfo</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_faq"><a class="anchor" href="#_faq"></a>Appendix A: FAQ</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_about"><a class="anchor" href="#_about"></a>A.1. About</h3>
<div class="sect3">
<h4 id="_the_project"><a class="anchor" href="#_the_project"></a>A.1.1. The project</h4>
<div class="sect4">
<h5 id="_what_is_bridj"><a class="anchor" href="#_what_is_bridj"></a>What is BridJ ?</h5>
<div class="paragraph">
<p>BridJ is a library that lets you call <a href="#_bridj_c">C</a>, <a href="#_bridj_cpp">C++</a> and [ObjectiveC Objective-C] libraries from Java as if you were writing native code. It is a recent alternative to <a href="http://jna.dev.java.net">JNA</a>.</p>
</div>
<div class="paragraph">
<p>With the help of <a href="http://jnaerator.googlecode.com/">JNAerator</a>, it provides <a href="#_bridj_type_mapping">clean and unambiguous mappings</a> to C/C++ code and a very straightforward and highly typed API to manipulate pointers, classes, structs, unions&#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>It bridges Java&#8217;s gap when it comes to native-world interoperability.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>For instance, you can allocate a <code>new float[10]</code> almost as in C++ :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="c++"><span class="directive">void</span> someFunc(<span class="predefined-type">float</span>* values);

<span class="predefined-type">float</span>* array = <span class="keyword">new</span> <span class="predefined-type">float</span>[<span class="integer">10</span>];
<span class="predefined-type">float</span> value = array[<span class="integer">4</span>];
someFunc(array);
<span class="keyword">delete</span>[] array;</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Scala</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="scala">import org.bridj.Pointer._
...
@native def someFunc(values: Pointer[Float]): Unit
...
val array = allocateFloats(10)
val value = array(4)
someFunc(values)

array.release</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Java</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.bridj.Pointer</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.bridj.Pointer</span>.*;
...
public <span class="directive">static</span> <span class="directive">native</span> <span class="type">void</span> someFunc(Pointer&lt;<span class="predefined-type">Float</span>&gt; values);
...
Pointer&lt;<span class="predefined-type">Float</span>&gt; array = allocateFloats(<span class="integer">10</span>);
<span class="type">float</span> value = array.get(<span class="integer">4</span>);
someFunc(values);
array.release();</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Read more about:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#_bridj_pointers">BridJ &amp; Pointers</a></p>
</li>
<li>
<p><a href="#_bridj_type_mapping">BridJ &amp; Type Mapping</a></p>
</li>
<li>
<p><a href="#_bridj_c">BridJ &amp; C</a></p>
</li>
<li>
<p><a href="#_bridj_cpp">BridJ &amp; CPP</a></p>
</li>
<li>
<p><a href="#_com">COM</a></p>
</li>
<li>
<p><a href="#_design">Design</a></p>
</li>
<li>
<p><a href="#_bridj_scala">BridJ &amp; Scala</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_i_found_a_bug_in_bridj_where_do_i_report_it"><a class="anchor" href="#_i_found_a_bug_in_bridj_where_do_i_report_it"></a>I found a bug in BridJ ! Where do I report it ?</h5>
<div class="paragraph">
<p>Getting lots of bug reports is crucial to making BridJ better, so we&#8217;d like to encourage you to file issues as you find them without worrying too much about the contents : it&#8217;s often better for us to have an incomplete report than no report at all, and anyway we&#8217;ll let you know very politely if your issue comes from a misuse rather than a bug in BridJ.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s the issue tracker : <a href="https://github.com/ochafik/nativelibs4java/issues">NativeLibs4Java&#8217;s Issues on GitHub</a>.</p>
</div>
<div class="paragraph">
<p>And here&#8217;s a guide on <a href="#_submitting_bugs">Submitting Bugs</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_why_another_interop_library"><a class="anchor" href="#_why_another_interop_library"></a>Why another interop library ?</h5>
<div class="paragraph">
<p>In three words : <a href="#_design">Design</a>, <a href="#_bridj_cpp">C++</a>, Performance and Usability</p>
</div>
</div>
<div class="sect4">
<h5 id="_what_is_bridj_s_license"><a class="anchor" href="#_what_is_bridj_s_license"></a>What is BridJ&#8217;s license ?</h5>
<div class="paragraph">
<p>BridJ is <a href="#_credits_and_license">dual-licensed under a very liberal BSD license and the very liberal Apache 2.0 license</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_what_are_bridj_s_runtime_dependencies"><a class="anchor" href="#_what_are_bridj_s_runtime_dependencies"></a>What are BridJ&#8217;s runtime dependencies ?</h5>
<div class="paragraph">
<p>BridJ is released as a self-contained JAR.</p>
</div>
<div class="paragraph">
<p>However, it includes a copy of the <a href="http://asm.ow2.org/">ASM</a> library and its native library are statically linked with a modified version of <a href="http://dyncall.org">Dyncall</a>.</p>
</div>
<div class="paragraph">
<p>More details here : <a href="#_credits_and_license">Credits and License</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_where_can_i_get_support_for_bridj"><a class="anchor" href="#_where_can_i_get_support_for_bridj"></a>Where can I get support for BridJ ?</h5>
<div class="paragraph">
<p>On <a href="http://groups.google.com/group/nativelibs4java">NativeLibs4Java&#8217;s mailing-list</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_what_is_bridj_s_development_status"><a class="anchor" href="#_what_is_bridj_s_development_status"></a>What is BridJ&#8217;s development status ?</h5>
<div class="paragraph">
<p>Please read the <a href="https://github.com/ochafik/nativelibs4java/blob/master/libraries/Runtime/BridJ/CHANGELOG">Change Log</a> and have a look at the <a href="#_current_state">Current State</a> page.</p>
</div>
</div>
<div class="sect4">
<h5 id="_what_platforms_does_bridj_support"><a class="anchor" href="#_what_platforms_does_bridj_support"></a>What platforms does BridJ support ?</h5>
<div class="paragraph">
<p>Binaries are currently available and routinely tested for the following platforms :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Windows (x86, x64)</p>
</li>
<li>
<p>Linux (x86, x64, armhf, armel)</p>
</li>
<li>
<p>Mac OS X (x86, x64, ppc)</p>
</li>
<li>
<p>Solaris 10 (x86&#8230;&#8203; soon x64 and sparc)</p>
</li>
<li>
<p>Android 3.0 (armv5)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>(<a href="#_credits_and_license">help and / or test hardward welcome</a> to help with other platforms)</p>
</div>
</div>
<div class="sect4">
<h5 id="_can_i_build_bridj_from_sources"><a class="anchor" href="#_can_i_build_bridj_from_sources"></a>Can I build BridJ from sources ?</h5>
<div class="paragraph">
<p>Sure, please read <a href="#_build">Build</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_can_i_help"><a class="anchor" href="#_how_can_i_help"></a>How can I help ?</h5>
<div class="paragraph">
<p>Please read <a href="#_contributing_to_bridj">Contributing to BridJ</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_how_is_bridj_different_from"><a class="anchor" href="#_how_is_bridj_different_from"></a>A.1.2. How is BridJ different from&#8230;&#8203;</h4>
<div class="sect4">
<h5 id="_jna"><a class="anchor" href="#_jna"></a>JNA</h5>
<div class="sect5">
<h6 id="_things_bridj_aims_at_doing_better_than_jna"><a class="anchor" href="#_things_bridj_aims_at_doing_better_than_jna"></a>Things BridJ aims at doing better than JNA :</h6>
<div class="ulist">
<ul>
<li>
<p>BridJ is BSD-licensed (while JNA is LGPL)</p>
</li>
<li>
<p><a href="#_bridj_cpp">Supports C++</a> (really : virtual methods, inheritance, templates&#8230;&#8203;)</p>
</li>
<li>
<p>Vastly better structs : lightweight, fast (one or two orders of magnitude faster to create), without any data duplication</p>
</li>
<li>
<p>Better performance for most function calls :</p>
<div class="ulist">
<ul>
<li>
<p>Direct mode is the default</p>
</li>
<li>
<p>Some calls are optimized with assembly code to reach near-JNI performance</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="#_com">Supports COM</a> (special case of C++ support) : lets you use "real" Windows APIs (IShellFolder, ITaskBarList3&#8230;&#8203;)</p>
</li>
<li>
<p><a href="#_bridj_type_mapping">Cleaner API</a> with Java 1.5 generics :</p>
<div class="ulist">
<ul>
<li>
<p><a href="#_bridj_pointers">Iterable and typed <code>Pointer&lt;T&gt;</code></a></p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.bridj.Pointer</span>.*;
...
Pointer&lt;<span class="predefined-type">Integer</span>&gt; p = pointerToInts(<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>, <span class="integer">4</span>);
p.set(<span class="integer">0</span>, <span class="integer">10</span>);
<span class="keyword">for</span> (<span class="type">int</span> v : p)
  <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">Next value : </span><span class="delimiter">&quot;</span></span> + v);</code></pre>
</div>
</div>
</li>
<li>
<p>Typed enums (that can still be combined as flags)</p>
</li>
<li>
<p>No such thing as IntByReference, LongByReference&#8230;&#8203; Simply use <code>Pointer&lt;Integer&gt;</code>, <code>Pointer&lt;Long&gt;</code>&#8230;&#8203;</p>
</li>
<li>
<p>No such thing as Structure.ByReference vs. Structure.ByValue : if a function accepts a pointer to MyStruct, it&#8217;s gonna be <code>f(Pointer&lt;MyStruct&gt; s)</code>, if it accepts a MyStruct by value it will be <code>f(MyStruct s)</code>. Simple.</p>
</li>
<li>
<p>Wanna cast a pointer to a function pointer ? <code>ptr.as(MyFunctionPointer.class)</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Pervasive multiple endianness support : if you retrieved a pointer to some GPU-filled memory and you know the GPU is little-endian while your CPU is big-endian, you can just call <code>myPtr.order(ByteOrder.LITTLE_ENDIAN)</code>. You can then retrieve data from it as usual, and even cast to a struct pointer : it will just work as intended.</p>
</li>
<li>
<p>BridJ has better <a href="http://jnaerator.googlecode.com/">JNAerator</a> support (in particular, the experimental <code>-convertBodies</code> option will convert function bodies from C/C++ into Java/BridJ code !), so you won&#8217;t need to write any interface by hand.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_jna_s_advantages_over_bridj"><a class="anchor" href="#_jna_s_advantages_over_bridj"></a>JNA&#8217;s advantages over BridJ :</h6>
<div class="ulist">
<ul>
<li>
<p>BridJ doesn&#8217;t handle structs by value in function calls yet (neither in arguments nor in return value). This is being worked on, though.</p>
</li>
<li>
<p>JNA is Java 1.4 compatible (while BridJ requires Java 1.5+)</p>
</li>
<li>
<p>JNA is mature and stable, used by <strong>many</strong> projects</p>
</li>
<li>
<p>BridJ supports less platforms (Windows 32/64, MacOS X Universal, Linux x86/amd64/armhf/armel for now)</p>
</li>
<li>
<p>JNA has tons of working examples</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_swig"><a class="anchor" href="#_swig"></a>SWIG</h5>
<div class="paragraph">
<p>BridJ&#8217;s advantages :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it only requires you to build your Java program, whereas SWIG requires a painful native build on every target platform</p>
</li>
<li>
<p>the resulting API is generally nicer looking, without any manual configuration involved</p>
</li>
<li>
<p>you work directly with the original C/C++ headers, no need to write special header as with SWIG</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>SWIG&#8217;s advantages :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it&#8217;s C++ support is much more solid : once it compiles, you&#8217;re pretty sure it&#8217;s gonna work (with BridJ, errors will show up at runtime, typically at startup)</p>
</li>
<li>
<p>it has support for STL types (std::string, std::vector&#8230;&#8203;)</p>
</li>
<li>
<p>it&#8217;s more mature and stable</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_usage"><a class="anchor" href="#_usage"></a>A.1.3. Usage</h4>
<div class="sect4">
<h5 id="_how_do_i_bind_c_c_function_struct_class_type_xxx_with_bridj"><a class="anchor" href="#_how_do_i_bind_c_c_function_struct_class_type_xxx_with_bridj"></a>How do I bind C / C++ function / struct / class / type XXX with BridJ ?</h5>
<div class="paragraph">
<p>Just paste your C header <a href="http://jnaerator.sourceforge.net/webstart/JNAerator/JNAeratorStudio.jnlp">into JNAerator</a>, choose BridJ as runtime and click on JNAerate.</p>
</div>
</div>
<div class="sect4">
<h5 id="_can_i_ship_my_library_s_binaries_in_a_cross_platform_jar"><a class="anchor" href="#_can_i_ship_my_library_s_binaries_in_a_cross_platform_jar"></a>Can I ship my library&#8217;s binaries in a cross-platform JAR ?</h5>
<div class="paragraph">
<p>You sure can ! BridJ provides a seamless cross-platform binaries JAR extraction mechanism, which it uses for its own needs.</p>
</div>
<div class="paragraph">
<p>For detailed information about embedded libraries, please read [LibrariesLookup Libraries Lookup].</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_can_i_trace_log_the_native_calls"><a class="anchor" href="#_how_can_i_trace_log_the_native_calls"></a>How can I trace/log the native calls ?</h5>
<div class="paragraph">
<p>You can set the <code>-Dbridj.logCalls=true</code> property or the <code>BRIDJ_LOG_CALLS=1</code> environment variable.</p>
</div>
<div class="paragraph">
<p>In this log mode :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>only the Java method will be logged (no arguments nor return value)</p>
</li>
<li>
<p>direct calls will be disabled (those wired with optimized assembler glue), so performance might be degraded a bit</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_how_to_specify_different_calling_conventions_for_different_platforms"><a class="anchor" href="#_how_to_specify_different_calling_conventions_for_different_platforms"></a>How to specify different calling conventions for different platforms ?</h5>
<div class="paragraph">
<p>Short answer is : you don&#8217;t need to.</p>
</div>
<div class="paragraph">
<p>Only Windows x86 has different calling conventions, so <code>@Convention</code> annotations will typically be ignored silently on other platforms.</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_to_i_check_for_errno_code_getlasterror_code"><a class="anchor" href="#_how_to_i_check_for_errno_code_getlasterror_code"></a>How to I check for errno / <code>GetLastError()</code> ?</h5>
<div class="paragraph">
<p>Simply declare that your function throws <a href="http://nativelibs4java.sourceforge.net/bridj/api/development/org/bridj/LastError.html">LastError</a>, that&#8217;s it !</p>
</div>
<div class="paragraph">
<p>You&#8217;ll get exceptions soon enough ;-)</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_troubleshooting"><a class="anchor" href="#_troubleshooting"></a>A.1.4. Troubleshooting</h4>
<div class="sect4">
<h5 id="_bridj_hangs_with_100_cpu_usage"><a class="anchor" href="#_bridj_hangs_with_100_cpu_usage"></a>BridJ hangs with 100% CPU usage !</h5>
<div class="paragraph">
<p>If you&#8217;re on Windows x86 (or on 64 bits windows in a 32 bits JVM), this is typically a case of bad calling convention being used for a native function or callback binding.
Please triple-check the calling convention (could it be <code>__stdcall</code> ?) and add a proper <code>@Convention(Convention.Style.xxx)</code> annotation.</p>
</div>
</div>
<div class="sect4">
<h5 id="_segmentation_faults_when_using_callbacks"><a class="anchor" href="#_segmentation_faults_when_using_callbacks"></a>Segmentation faults when using callbacks?</h5>
<div class="paragraph">
<p>You need to keep strong references to callbacks, otherwise they&#8217;ll be garbage-collected and the native code will crash when trying to call them.</p>
</div>
<div class="paragraph">
<p>You can use <a href="http://nativelibs4java.sourceforge.net/bridj/api/development/org/bridj/BridJ.html#protectFromGC(T)">BridJ.protectFromGC</a> to do that, or use your own strong references with finer-grained lifespan.</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_do_i_debug_an_exception_access_violation_crash"><a class="anchor" href="#_how_do_i_debug_an_exception_access_violation_crash"></a>How do I debug an EXCEPTION_ACCESS_VIOLATION crash ?</h5>
<div class="paragraph">
<p>This crash indicates that the program tried to access memory it wasn&#8217;t supposed to access (for instance someone read at index 100 in an array of 10 elements).</p>
</div>
<div class="paragraph">
<p>It may also be caused by an invalid calling convention being used, see previous FAQ item)</p>
</div>
<div class="paragraph">
<p>The tricky part here is that this kind of errors usually does not surface immediately : the crash will typically occur in later calls, giving false leads on where the error actually occurred.</p>
</div>
<div class="paragraph">
<p>The only reliable way to debug such errors is to make use of a native debugger. On Windows, Visual C++ comes with a very nice debugger and is available for free in its Express edition (under some conditions).</p>
</div>
<div class="paragraph">
<p>To debug your crash with Visual C++, you should compile your native library in debug mode if possible, then run the java process with the debugger (or attach a debugger to it before any native call is performed). You&#8217;ll want to turn as many debug checks on as possible in the <a href="http://msdn.microsoft.com/en-us/library/x85tt0dd.aspx">debugger settings</a>.</p>
</div>
<div class="paragraph">
<p>Also, it will be easier to set the full path to the debug version of your DLL using a manual path override : if your library is named <code>MyLib</code> in BridJ (the value inside the <code>@Library("MyLib")</code> annotation), you can :
  * Set the path in the run properties dialog with the following environment variable :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>BRIDJ_MYLIB_LIBRARY=c:\...\MyProject\Debug\MyLib.dll</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Or add the following property argument to your java process command-line :</p>
<div class="literalblock">
<div class="content">
<pre>"-Dbridj.MyLib.library=c:\...\MyLib.dll"</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can then check which exact version of your DLL was picked by BridJ by scanning through Visual C++'s "Modules" window.</p>
</div>
<div class="paragraph">
<p>As far as BridJ is concerned, you may try turning the direct mode off with <code>BRIDJ_DIRECT=0</code> or <code>-Dbridj.direct=false</code> and see if the issue still happens.</p>
</div>
<div class="paragraph">
<p>A last option would be to turn BridJ&#8217;s "protected" mode on, but right now you&#8217;d have to [Build recompile it from sources] and uncomment the <code>#define ENABLE_PROTECTED_MODE</code> directive in <code>Exceptions.h</code>. Note that protected mode is currently slow and unstable which is why it&#8217;s not enabled by default ;-).</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_do_i_debug_a_code_loadlibrary_the_specified_module_could_not_be_found_code_error"><a class="anchor" href="#_how_do_i_debug_a_code_loadlibrary_the_specified_module_could_not_be_found_code_error"></a>How do I debug a <code>LoadLibrary : The specified module could not be found</code> error ?</h5>
<div class="paragraph">
<p>If BridJ fails to load a library, it can be that :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>you&#8217;re trying to load a 64 bits on a 32 bits platform, or vice-versa (please check which version <code>java -version</code> yields : if it does not say it&#8217;s 64 bits, it means it&#8217;s 32 bits)</p>
</li>
<li>
<p>it didn&#8217;t find the exact path you specified</p>
</li>
<li>
<p>it didn&#8217;t find a DLL dependency of the library you&#8217;re trying to load (please open your DLL with <a href="http://www.dependencywalker.com/">Dependency Walker</a> and make sure all its dependencies are resolved and in the path). Dependent libraries must be declared as:</p>
<div class="literalblock">
<div class="content">
<pre>@Library("MainLib", dependencies = { "Dependency1", "Dependency2"... })</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_how_do_i_debug_an_code_unsatisfiedlinkerror_code"><a class="anchor" href="#_how_do_i_debug_an_code_unsatisfiedlinkerror_code"></a>How do I debug an <code>UnsatisfiedLinkError</code>?</h5>
<div class="paragraph">
<p>This means your native method was not successfully registered by BridJ. You should:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Make sure you&#8217;ve added a <code>static { BridJ.register(); }</code> block in your class</p>
</li>
<li>
<p>Inspect BridJ&#8217;s verbose logs (set the <code>BRIDJ_VERBOSE=1</code> or <code>BRIDJ_DEBUG=1</code> environment variables, or the <code>-Dbridj.verbose=true</code> or <code>-Dbridj.debug=true</code> System properties through command-line flags)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the logs show that BridJ did try and register your method(s) but failed to find the relevant symbols in your shared library (.dll, .so, .dylib), then:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Make sure you&#8217;ve got the right DLL name</p>
</li>
<li>
<p>Inspect the library&#8217;s symbols with Dependency Walker (for Windows DLLs) or <code>nm</code> / <code>otool</code> (for Unix binaries)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the (mangled) symbol is indeed present in the library, BridJ&#8217;s demangler might have a bug (or two) that prevented it from matching the symbol with your signature. You can try and put the raw (mangled) symbol in a <code>org.bridj.ann.Symbol</code> annotation on the method.</p>
</div>
<div class="paragraph">
<p>If none of this works, please <a href="https://github.com/ochafik/nativelibs4java/issues">file a bug</a> or <a href="http://groups.google.com/group/nativelibs4java">ask the mailing-list</a>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_credits_and_license"><a class="anchor" href="#_credits_and_license"></a>Appendix B: Credits and License</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_main_author"><a class="anchor" href="#_main_author"></a>B.1. Main author</h3>
<div class="paragraph">
<p>Olivier Chafik (author of <a href="http://code.google.com/p/bridj/">BridJ</a>, <a href="http://code.google.com/p/jnaerator/">JNAerator</a>, <a href="http://code.google.com/p/javacl/">JavaCL</a> and <a href="http://code.google.com/p/scalacl/">ScalaCL</a>)</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://ochafik.free.fr/blog/">Blog : Ch zOlive</a></p>
</li>
<li>
<p><a href="http://twitter.com/ochafik">Twitter : @ochafik</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_contributors"><a class="anchor" href="#_contributors"></a>B.2. Contributors</h3>
<div class="ulist">
<ul>
<li>
<p><a href="http://twitter.com/remiemonet">Rmi Emonet</a> : many enhancements in BridJ&#8217;s GCC demangler</p>
</li>
<li>
<p><a href="http://kazocsaba.blogspot.com/">Kaz Csaba</a> : bug reports + patches for JavaCL (kernel binaries, reduction utilities&#8230;&#8203;)</p>
</li>
<li>
<p>Andrei Sochirca : intense bug reporting and many suggestions that drove <a href="https://github.com/ochafik/nativelibs4java/tree/master/libraries/BridJ/CHANGELOG#">release 0.4.1</a> of BridJ</p>
</li>
<li>
<p><a href="https://github.com/atsushieno">Atsushi Eno</a> : testing and many patch proposals that helped support BridJ on Android</p>
</li>
<li>
<p><a href="http://bbboblog.blogspot.com/">Bob Boothby</a> : Mandelbrot demo in JavaCL</p>
</li>
<li>
<p>Jeff Palmer : moderation of <a href="http://groups.google.com/group/nativelibs4java">the mailing list</a> and support to JavaCL users</p>
</li>
<li>
<p><a href="http://www.ok.ctrl.titech.ac.jp/~saudet/">Samuel Audet</a> : support to JavaCL users</p>
</li>
<li>
<p>Countless <a href="http://github.com/ochafik/nativelibs4java/issues">bug reporters</a>, whose energy and patience are a great motivation !</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_generous_donors"><a class="anchor" href="#_generous_donors"></a>B.3. Generous donors</h3>
<div class="ulist">
<ul>
<li>
<p>Matthew S. (Paypal donation)</p>
</li>
<li>
<p><a href="http://freeldssheetmusic.org/">Roger Pack</a> (Paypal donation)</p>
</li>
<li>
<p>Tishampati Dhar (Paypal donation)</p>
</li>
<li>
<p>NeZetiC (donation of a Sun Ultra 5 computer so I can work on the BridJ+dyncall Sparc port)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>While I&#8217;m working on these projects for the fun of it on my free time, I still don&#8217;t own any sports car&#8230;&#8203; Any donation will be greatly appreciated :
  &lt;a href="http://sourceforge.net/donate/index.php?group_id=266856"&gt;&lt;img src="http://images.sourceforge.net/images/project-support.jpg" width="88" height="32" border="0" alt="Become a sponsor" /&gt;&lt;/a&gt;</p>
</div>
</div>
<div class="sect2">
<h3 id="_projects_used"><a class="anchor" href="#_projects_used"></a>B.4. Projects Used</h3>
<div class="paragraph">
<p>BridJ uses the following libraries :
  * <a href="http://dyncall.org">dyncall</a>, an excellent lightweight FFI library distributed under <a href="http://dyncall.org/license.shtml">an ISC-style license</a> (reproduced below).
  Daniel Adler and Tassilo Philipp (authors of <a href="http://dyncall.org/">dyncall</a>) have been very supportive and kindly accepted and/or adapted most if not all of the patches I submitted to them, many thanks !
  To patch dyncall with BridJ&#8217;s modifications, type :
{{{
wget <a href="http://nativelibs4java.googlecode.com/svn/trunk/libraries/BridJ/admin/patch_dyncall.sh" class="bare">http://nativelibs4java.googlecode.com/svn/trunk/libraries/BridJ/admin/patch_dyncall.sh</a>
bash patch_dyncall.sh dyncall
}}}
  * <a href="http://asm.ow2.org/">ASM</a>, a Java code generation library distributed under <a href="http://asm.ow2.org/license.html">a 3-clauses BSD-style license</a> (reproduced below).</p>
</div>
<div class="paragraph">
<p>Note that BridJ ships with these libraries, so you don&#8217;t need to put them in the path or install them to your system : <strong>BridJ&#8217;s JAR file is self-contained.</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="_projects_that_use_bridj"><a class="anchor" href="#_projects_that_use_bridj"></a>B.5. Projects that use BridJ</h3>
<div class="paragraph">
<p>See [WhoUsesBridJ]</p>
</div>
</div>
<div class="sect2">
<h3 id="_licenses"><a class="anchor" href="#_licenses"></a>B.6. Licenses</h3>
<div class="sect3">
<h4 id="_bridj_javacl_scalacl_license_3_clauses_bsd_like"><a class="anchor" href="#_bridj_javacl_scalacl_license_3_clauses_bsd_like"></a>B.6.1. BridJ, JavaCL &amp; ScalaCL License (3-clauses BSD-like)</h4>
<div class="listingblock">
<div class="content">
<pre>Copyright (c) 2010-2013, Olivier Chafik
All rights reserved.
Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
  * Neither the name of Olivier Chafik nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE REGENTS AND CONTRIBUTORS BE LIABLE FOR ANY
DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_dyncall_license_2_clauses_bsd_like"><a class="anchor" href="#_dyncall_license_2_clauses_bsd_like"></a>B.6.2. dyncall License (2-clauses BSD-like)</h4>
<div class="paragraph">
<p><a href="http://dyncall.org">dyncall</a> is redistributed in binary form in BridJ&#8217;s binary downloads an in its source tree, and in source form in its source tree.</p>
</div>
<div class="paragraph">
<p>It is originally distributed under an <a href="http://dyncall.org/license.shtml">an ISC-style license</a> (see <a href="http://en.wikipedia.org/wiki/ISC_license">Wikipedia&#8217;s page about the ISC license</a>) :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Copyright (c) 2007-2010
                        Daniel Adler &lt;dadler AT uni-goettingen DOT de&gt;,
                        Tassilo Philipp &lt;tphilipp AT potion-studios DOT com&gt;

Permission to use, copy, modify, and distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_asm_license_3_clauses_bsd_like"><a class="anchor" href="#_asm_license_3_clauses_bsd_like"></a>B.6.3. ASM License (3-clauses BSD-like)</h4>
<div class="paragraph">
<p><a href="http://asm.ow2.org/">ASM</a> is redistributed in binary form in BridJ&#8217;s binary downloads.</p>
</div>
<div class="paragraph">
<p>It is originally distributed under a <a href="http://asm.ow2.org/license.html">3-clauses BSD-style license</a> (see <a href="http://en.wikipedia.org/wiki/BSD_Licence">Wikipedia&#8217;s page about the BSD license</a>) :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Copyright (c) 2000-2005 INRIA, France Telecom
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

1. Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in the
   documentation and/or other materials provided with the distribution.

3. Neither the name of the copyright holders nor the names of its
   contributors may be used to endorse or promote products derived from
   this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
THE POSSIBILITY OF SUCH DAMAGE.</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version latest<br>
Last updated 2017-05-18 19:44:34 UTC
</div>
</div>
</body>
</html>